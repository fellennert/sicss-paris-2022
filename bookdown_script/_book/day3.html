<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Day 3 Scraping the web – extracting data | Course script for SICSS Paris</title>
  <meta name="description" content="This book serves as an accompanying script for the R sessions of the 2022 Summer Institute for Computational Social Science (SICSS), taking place at the Institut Polytechnique de Paris." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Day 3 Scraping the web – extracting data | Course script for SICSS Paris" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This book serves as an accompanying script for the R sessions of the 2022 Summer Institute for Computational Social Science (SICSS), taking place at the Institut Polytechnique de Paris." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Day 3 Scraping the web – extracting data | Course script for SICSS Paris" />
  
  <meta name="twitter:description" content="This book serves as an accompanying script for the R sessions of the 2022 Summer Institute for Computational Social Science (SICSS), taking place at the Institut Polytechnique de Paris." />
  

<meta name="author" content="Germain Gauthier" />
<meta name="author" content="Felix Lennert" />
<meta name="author" content="Étienne Ollion" />


<meta name="date" content="2022-06-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="day2.html"/>
<link rel="next" href="day4.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/str_view-0.1.0/str_view.css" rel="stylesheet" />
<script src="libs/str_view-binding-1.4.0/str_view.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Script for SICSS-Paris 2022</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#outline"><i class="fa fa-check"></i><b>1.1</b> Outline</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#setup-procedure"><i class="fa fa-check"></i><b>1.2</b> Setup procedure</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#registration-for-api-usage"><i class="fa fa-check"></i><b>1.2.1</b> Registration for API usage</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#docker-for-rselenium"><i class="fa fa-check"></i><b>1.2.2</b> Docker for <code>RSelenium</code></a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#some-useful-functions"><i class="fa fa-check"></i><b>1.2.3</b> Some useful functions</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#further-links"><i class="fa fa-check"></i><b>1.3</b> Further links</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#last-but-not-least"><i class="fa fa-check"></i><b>1.4</b> Last but not least</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="day2.html"><a href="day2.html"><i class="fa fa-check"></i><b>2</b> Scraping the web</a>
<ul>
<li class="chapter" data-level="2.1" data-path="day2.html"><a href="day2.html#making-requests"><i class="fa fa-check"></i><b>2.1</b> Making requests</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="day2.html"><a href="day2.html#session"><i class="fa fa-check"></i><b>2.1.1</b> <code>session()</code></a></li>
<li class="chapter" data-level="2.1.2" data-path="day2.html"><a href="day2.html#forms"><i class="fa fa-check"></i><b>2.1.2</b> Forms</a></li>
<li class="chapter" data-level="2.1.3" data-path="day2.html"><a href="day2.html#scraping-hacks"><i class="fa fa-check"></i><b>2.1.3</b> Scraping hacks</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="day2.html"><a href="day2.html#application-programming-interfaces-apis"><i class="fa fa-check"></i><b>2.2</b> Application Programming Interfaces (APIs)</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="day2.html"><a href="day2.html#obtaining-their-data"><i class="fa fa-check"></i><b>2.2.1</b> Obtaining their data</a></li>
<li class="chapter" data-level="2.2.2" data-path="day2.html"><a href="day2.html#rtweet"><i class="fa fa-check"></i><b>2.2.2</b> <code>rtweet</code></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="day2.html"><a href="day2.html#further-links-1"><i class="fa fa-check"></i><b>2.3</b> Further links</a></li>
<li class="chapter" data-level="2.4" data-path="day2.html"><a href="day2.html#exercises"><i class="fa fa-check"></i><b>2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="day3.html"><a href="day3.html"><i class="fa fa-check"></i><b>3</b> Scraping the web – extracting data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="day3.html"><a href="day3.html#html-101"><i class="fa fa-check"></i><b>3.1</b> HTML 101</a></li>
<li class="chapter" data-level="3.2" data-path="day3.html"><a href="day3.html#extracting-content-in-rvest"><i class="fa fa-check"></i><b>3.2</b> Extracting content in <code>rvest</code></a></li>
<li class="chapter" data-level="3.3" data-path="day3.html"><a href="day3.html#scraping-html-pages-with-rvest"><i class="fa fa-check"></i><b>3.3</b> Scraping HTML pages with <code>rvest</code></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="day3.html"><a href="day3.html#html_text-and-html_text2"><i class="fa fa-check"></i><b>3.3.1</b> <code>html_text()</code> and <code>html_text2()</code></a></li>
<li class="chapter" data-level="3.3.2" data-path="day3.html"><a href="day3.html#extracting-tables"><i class="fa fa-check"></i><b>3.3.2</b> Extracting tables</a></li>
<li class="chapter" data-level="3.3.3" data-path="day3.html"><a href="day3.html#extracting-attributes"><i class="fa fa-check"></i><b>3.3.3</b> Extracting attributes</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="day3.html"><a href="day3.html#automating-scraping"><i class="fa fa-check"></i><b>3.4</b> Automating scraping</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="day3.html"><a href="day3.html#looping-over-pages"><i class="fa fa-check"></i><b>3.4.1</b> Looping over pages</a></li>
<li class="chapter" data-level="3.4.2" data-path="day3.html"><a href="day3.html#letting-the-scraper-navigate-on-its-own"><i class="fa fa-check"></i><b>3.4.2</b> Letting the scraper navigate on its own</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="day3.html"><a href="day3.html#conclusion"><i class="fa fa-check"></i><b>3.5</b> Conclusion</a></li>
<li class="chapter" data-level="3.6" data-path="day3.html"><a href="day3.html#further-links-2"><i class="fa fa-check"></i><b>3.6</b> Further links</a></li>
<li class="chapter" data-level="3.7" data-path="day3.html"><a href="day3.html#exercises-1"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="day4.html"><a href="day4.html"><i class="fa fa-check"></i><b>4</b> Text preprocessing</a>
<ul>
<li class="chapter" data-level="4.1" data-path="day4.html"><a href="day4.html#basic-manipulations"><i class="fa fa-check"></i><b>4.1</b> Basic manipulations</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="day4.html"><a href="day4.html#changing-the-case-of-the-words"><i class="fa fa-check"></i><b>4.1.1</b> Changing the case of the words</a></li>
<li class="chapter" data-level="4.1.2" data-path="day4.html"><a href="day4.html#determining-a-strings-length"><i class="fa fa-check"></i><b>4.1.2</b> Determining a string’s length</a></li>
<li class="chapter" data-level="4.1.3" data-path="day4.html"><a href="day4.html#extracting-particular-characters"><i class="fa fa-check"></i><b>4.1.3</b> Extracting particular characters</a></li>
<li class="chapter" data-level="4.1.4" data-path="day4.html"><a href="day4.html#concatenating-strings"><i class="fa fa-check"></i><b>4.1.4</b> Concatenating strings</a></li>
<li class="chapter" data-level="4.1.5" data-path="day4.html"><a href="day4.html#repetition"><i class="fa fa-check"></i><b>4.1.5</b> Repetition</a></li>
<li class="chapter" data-level="4.1.6" data-path="day4.html"><a href="day4.html#removing-unnecessary-whitespaces"><i class="fa fa-check"></i><b>4.1.6</b> Removing unnecessary whitespaces</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="day4.html"><a href="day4.html#regular-expressions"><i class="fa fa-check"></i><b>4.2</b> Regular expressions</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="day4.html"><a href="day4.html#literal-characters"><i class="fa fa-check"></i><b>4.2.1</b> Literal characters</a></li>
<li class="chapter" data-level="4.2.2" data-path="day4.html"><a href="day4.html#metacharacters"><i class="fa fa-check"></i><b>4.2.2</b> Metacharacters</a></li>
<li class="chapter" data-level="4.2.3" data-path="day4.html"><a href="day4.html#sets-of-characters"><i class="fa fa-check"></i><b>4.2.3</b> Sets of characters</a></li>
<li class="chapter" data-level="4.2.4" data-path="day4.html"><a href="day4.html#anchors"><i class="fa fa-check"></i><b>4.2.4</b> Anchors</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="day4.html"><a href="day4.html#more-advanced-string-manipulation"><i class="fa fa-check"></i><b>4.3</b> More advanced string manipulation</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="day4.html"><a href="day4.html#detect-matches"><i class="fa fa-check"></i><b>4.3.1</b> Detect matches</a></li>
<li class="chapter" data-level="4.3.2" data-path="day4.html"><a href="day4.html#mutating-strings"><i class="fa fa-check"></i><b>4.3.2</b> Mutating strings</a></li>
<li class="chapter" data-level="4.3.3" data-path="day4.html"><a href="day4.html#extracting-text"><i class="fa fa-check"></i><b>4.3.3</b> Extracting text</a></li>
<li class="chapter" data-level="4.3.4" data-path="day4.html"><a href="day4.html#split-vectors"><i class="fa fa-check"></i><b>4.3.4</b> Split vectors</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="day4.html"><a href="day4.html#featurization-of-text"><i class="fa fa-check"></i><b>4.4</b> Featurization of text</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="day4.html"><a href="day4.html#pre-processing-with-tidytext"><i class="fa fa-check"></i><b>4.4.1</b> Pre-processing with <code>tidytext</code></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="day4.html"><a href="day4.html#preprocessing-with-spacy"><i class="fa fa-check"></i><b>4.5</b> Preprocessing with <code>spaCy</code></a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="day4.html"><a href="day4.html#initializing-spacy"><i class="fa fa-check"></i><b>4.5.1</b> Initializing spacy</a></li>
<li class="chapter" data-level="4.5.2" data-path="day4.html"><a href="day4.html#spacy_parse"><i class="fa fa-check"></i><b>4.5.2</b> <code>spacy_parse()</code></a></li>
<li class="chapter" data-level="4.5.3" data-path="day4.html"><a href="day4.html#pos-tags-ner-and-noun-phrases"><i class="fa fa-check"></i><b>4.5.3</b> POS tags, NER, and noun phrases</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="day4.html"><a href="day4.html#first-analyses"><i class="fa fa-check"></i><b>4.6</b> First analyses</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="day4.html"><a href="day4.html#counting-words-per-document"><i class="fa fa-check"></i><b>4.6.1</b> Counting words per document</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="day4.html"><a href="day4.html#converting-between-formats"><i class="fa fa-check"></i><b>4.7</b> Converting between formats</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="day4.html"><a href="day4.html#document-term-matrix"><i class="fa fa-check"></i><b>4.7.1</b> Document-term matrix</a></li>
<li class="chapter" data-level="4.7.2" data-path="day4.html"><a href="day4.html#document-feature-matrix"><i class="fa fa-check"></i><b>4.7.2</b> Document-feature matrix</a></li>
<li class="chapter" data-level="4.7.3" data-path="day4.html"><a href="day4.html#corpus-objects"><i class="fa fa-check"></i><b>4.7.3</b> Corpus objects</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="day4.html"><a href="day4.html#further-links-3"><i class="fa fa-check"></i><b>4.8</b> Further links</a></li>
<li class="chapter" data-level="4.9" data-path="day4.html"><a href="day4.html#exercises-2"><i class="fa fa-check"></i><b>4.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="day4.html"><a href="day4.html#regexes"><i class="fa fa-check"></i><b>4.9.1</b> Regexes</a></li>
<li class="chapter" data-level="4.9.2" data-path="day4.html"><a href="day4.html#preprocessing"><i class="fa fa-check"></i><b>4.9.2</b> Preprocessing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="day5.html"><a href="day5.html"><i class="fa fa-check"></i><b>5</b> Machine Learning</a>
<ul>
<li class="chapter" data-level="5.1" data-path="day5.html"><a href="day5.html#split-data"><i class="fa fa-check"></i><b>5.1</b> Split data</a></li>
<li class="chapter" data-level="5.2" data-path="day5.html"><a href="day5.html#pre-processing-and-featurization"><i class="fa fa-check"></i><b>5.2</b> Pre-processing and featurization</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="day5.html"><a href="day5.html#textrecipes-basic-example"><i class="fa fa-check"></i><b>5.2.1</b> <code>textrecipes</code> – basic example</a></li>
<li class="chapter" data-level="5.2.2" data-path="day5.html"><a href="day5.html#textrecipes-further-preprocessing-steps"><i class="fa fa-check"></i><b>5.2.2</b> <code>textrecipes</code> – further preprocessing steps</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="day5.html"><a href="day5.html#model-specification"><i class="fa fa-check"></i><b>5.3</b> Model specification</a></li>
<li class="chapter" data-level="5.4" data-path="day5.html"><a href="day5.html#model-training-workflows"><i class="fa fa-check"></i><b>5.4</b> Model training – <code>workflows</code></a></li>
<li class="chapter" data-level="5.5" data-path="day5.html"><a href="day5.html#model-evaluation"><i class="fa fa-check"></i><b>5.5</b> Model evaluation</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="day5.html"><a href="day5.html#hyperparameter-tuning"><i class="fa fa-check"></i><b>5.5.1</b> Hyperparameter tuning</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="day5.html"><a href="day5.html#final-fit"><i class="fa fa-check"></i><b>5.6</b> Final fit</a></li>
<li class="chapter" data-level="5.7" data-path="day5.html"><a href="day5.html#latent-dirichlet-allocation-lda"><i class="fa fa-check"></i><b>5.7</b> Latent Dirichlet Allocation (LDA)</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="day5.html"><a href="day5.html#document-term-matrix-1"><i class="fa fa-check"></i><b>5.7.1</b> Document-term matrix</a></li>
<li class="chapter" data-level="5.7.2" data-path="day5.html"><a href="day5.html#inferring-the-number-of-topics"><i class="fa fa-check"></i><b>5.7.2</b> Inferring the number of topics</a></li>
<li class="chapter" data-level="5.7.3" data-path="day5.html"><a href="day5.html#sense-making"><i class="fa fa-check"></i><b>5.7.3</b> Sense-making</a></li>
<li class="chapter" data-level="5.7.4" data-path="day5.html"><a href="day5.html#document-topic-probabilities"><i class="fa fa-check"></i><b>5.7.4</b> Document-topic probabilities</a></li>
<li class="chapter" data-level="5.7.5" data-path="day5.html"><a href="day5.html#structural-topic-models"><i class="fa fa-check"></i><b>5.7.5</b> Structural Topic Models</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="day5.html"><a href="day5.html#further-readings"><i class="fa fa-check"></i><b>5.8</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="day6.html"><a href="day6.html"><i class="fa fa-check"></i><b>6</b> Word Embeddings</a></li>
<li class="chapter" data-level="7" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>7</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Course script for SICSS Paris</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="day3" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Day 3</span> Scraping the web – extracting data<a href="day3.html#day3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In Chapter <a href="day2.html#day2">2</a> you were shown how to make calls to web pages and get responses. Moreover, you were introduced to making calls to APIs which (usually) give you content in a nice and structured manner. In this chapter, the guiding topic will be how you can extract content from web pages that give you unstructured content in a structured way. The (in our opinion) easiest way to achieve that is by harnessing the way the web is written.</p>
<div id="html-101" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> HTML 101<a href="day3.html#html-101" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Web content is usually written in HTML (<strong>H</strong>yper <strong>T</strong>ext <strong>M</strong>arkup <strong>L</strong>anguage). An HTML document is comprised of elements that are letting its content appear in a certain way.</p>
<div class="figure">
<img src="https://www.w3schools.com/js/pic_htmltree.gif" alt="" />
<p class="caption">The tree-like structure of an HTML document</p>
</div>
<p>The way these elements look is defined by so-called tags.</p>
<p><img src="https://developer.mozilla.org/en-US/docs/Learn/Getting_started_with_the_web/HTML_basics/grumpy-cat-small.png" /></p>
<p>The opening tag is the name of the element (<code>p</code> in this case) in angle brackets, and the closing tag is the same with a forward slash before the name. <code>p</code> stands for a paragraph element and would look like this (since RMarkdown can handle HTML tags, the second line will showcase how it would appear on a web page:</p>
<p><code>&lt;p&gt; My cat is very grumpy. &lt;p/&gt;</code></p>
<p>
My cat is very grumpy.
<p/>
<p>The <code>&lt;p&gt;</code> tag makes sure that the text is standing by itself and that a line break is included thereafter:</p>
<p><code>&lt;p&gt;My cat is very grumpy&lt;/p&gt;. And so is my dog.</code> would look like this:</p>
<p>
My cat is very grumpy
</p>
<p>. And so is my dog.</p>
<p>There do exist many types of tags indicating different kinds of elements (about 100). Every page must be in an <code>&lt;html&gt;</code> element with two children <code>&lt;head&gt;</code> and <code>&lt;body&gt;</code>. The former contains the page title and some metadata, the latter the contents you are seeing in your browser. So-called <strong>block tags</strong>, e.g., <code>&lt;h1&gt;</code> (heading 1), <code>&lt;p&gt;</code> (paragraph), or <code>&lt;ol&gt;</code> (ordered list), structure the page. <strong>Inline tags</strong> (<code>&lt;b&gt;</code> – bold, <code>&lt;a&gt;</code> – link) format text inside block tags.</p>
<p>You can nest elements, e.g., if you want to make certain things bold, you can wrap text in <code>&lt;b&gt;</code>:</p>
<p>
My cat is <b> very </b> grumpy
</p>
<p>Then, the <code>&lt;b&gt;</code> element is considered the <em>child</em> of the <code>&lt;p&gt;</code> element.</p>
<p>Elements can also bear attributes:</p>
<p><img src="https://developer.mozilla.org/en-US/docs/Learn/Getting_started_with_the_web/HTML_basics/grumpy-cat-attribute-small.png" /></p>
<p>Those attributes will not appear in the actual content. Moreover, they are super-handy for us as scrapers. Here, <code>class</code> is the attribute name and <code>"editor-note"</code> the value. Another important attribute is <code>id</code>. Combined with CSS, they control the appearance of the element on the actual page. A <code>class</code> can be used by multiple HTML elements whereas an <code>id</code> is unique.</p>
</div>
<div id="extracting-content-in-rvest" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Extracting content in <code>rvest</code><a href="day3.html#extracting-content-in-rvest" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To scrape the web, the first step is to simply read in the web page. <code>rvest</code> then stores it in the XML format – just another format to store information. For this, we use <code>rvest</code>’s <code>read_html()</code> function.</p>
<p>To demonstrate the usage of CSS selectors, I create my own, basic web page using the <code>rvest</code> function <code>minimal_html()</code>:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="day3.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb81-2"><a href="day3.html#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb81-3"><a href="day3.html#cb81-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-4"><a href="day3.html#cb81-4" aria-hidden="true" tabindex="-1"></a>basic_html <span class="ot">&lt;-</span> <span class="fu">minimal_html</span>(<span class="st">&#39;</span></span>
<span id="cb81-5"><a href="day3.html#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;html&gt;</span></span>
<span id="cb81-6"><a href="day3.html#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;head&gt;</span></span>
<span id="cb81-7"><a href="day3.html#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;title&gt;Page title&lt;/title&gt;</span></span>
<span id="cb81-8"><a href="day3.html#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/head&gt;</span></span>
<span id="cb81-9"><a href="day3.html#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;body&gt;</span></span>
<span id="cb81-10"><a href="day3.html#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;h1 id=&quot;first&quot;&gt;A heading&lt;/h1&gt;</span></span>
<span id="cb81-11"><a href="day3.html#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;p class=&quot;paragraph&quot;&gt;Some text &amp;amp; &lt;b&gt;some bold text.&lt;/b&gt;&lt;/p&gt;</span></span>
<span id="cb81-12"><a href="day3.html#cb81-12" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;a&gt; Some more &lt;i&gt; italicized text which is not in a paragraph. &lt;/i&gt; &lt;/a&gt;</span></span>
<span id="cb81-13"><a href="day3.html#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;a class=&quot;paragraph&quot;&gt;even more text &amp;amp; &lt;i&gt;some italicized text.&lt;/i&gt;&lt;/p&gt;</span></span>
<span id="cb81-14"><a href="day3.html#cb81-14" aria-hidden="true" tabindex="-1"></a><span class="st">    &lt;a id=&quot;link&quot; href=&quot;www.nyt.com&quot;&gt; The New York Times &lt;/a&gt;</span></span>
<span id="cb81-15"><a href="day3.html#cb81-15" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;/body&gt;</span></span>
<span id="cb81-16"><a href="day3.html#cb81-16" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>)</span>
<span id="cb81-17"><a href="day3.html#cb81-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-18"><a href="day3.html#cb81-18" aria-hidden="true" tabindex="-1"></a>basic_html</span></code></pre></div>
<pre><code>## {html_document}
## &lt;html&gt;
## [1] &lt;head&gt;\n&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8 ...
## [2] &lt;body&gt;\n    &lt;h1 id=&quot;first&quot;&gt;A heading&lt;/h1&gt;\n    &lt;p class=&quot;paragraph&quot;&gt;Some  ...</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="day3.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#https://htmledit.squarefree.com</span></span></code></pre></div>
<p>CSS is the abbreviation for cascading style sheets and is used to define the visual styling of HTML documents. CSS selectors map elements in the HTML code to the relevant styles in the CSS. Hence, they define patterns that allow us to easily select certain elements on the page. CSS selectors can be used in conjunction with the <code>rvest</code> function <code>html_elements()</code> which takes as arguments the read-in page and a CSS selector. Alternatively, you can also provide an XPath which is usually a bit more complicated and will not be covered in this tutorial.</p>
<ul>
<li><code>p</code> selects all <code>&lt;p&gt;</code> elements.</li>
</ul>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="day3.html#cb84-1" aria-hidden="true" tabindex="-1"></a>basic_html <span class="sc">%&gt;%</span> <span class="fu">html_elements</span>(<span class="at">css =</span> <span class="st">&quot;h1&quot;</span>)</span></code></pre></div>
<pre><code>## {xml_nodeset (1)}
## [1] &lt;h1 id=&quot;first&quot;&gt;A heading&lt;/h1&gt;</code></pre>
<ul>
<li><code>.title</code> selects all elements that are of <code>class</code> “title”</li>
</ul>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="day3.html#cb86-1" aria-hidden="true" tabindex="-1"></a>basic_html <span class="sc">%&gt;%</span> <span class="fu">html_elements</span>(<span class="at">css =</span> <span class="st">&quot;.title&quot;</span>)</span></code></pre></div>
<pre><code>## {xml_nodeset (0)}</code></pre>
<p>There are no elements of <code>class</code> “title”. But some of <code>class</code> “paragraph”.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="day3.html#cb88-1" aria-hidden="true" tabindex="-1"></a>basic_html <span class="sc">%&gt;%</span> <span class="fu">html_elements</span>(<span class="at">css =</span> <span class="st">&quot;.paragraph&quot;</span>)</span></code></pre></div>
<pre><code>## {xml_nodeset (2)}
## [1] &lt;p class=&quot;paragraph&quot;&gt;Some text &amp;amp; &lt;b&gt;some bold text.&lt;/b&gt;&lt;/p&gt;
## [2] &lt;a class=&quot;paragraph&quot;&gt;even more text &amp;amp; &lt;i&gt;some italicized text.&lt;/i&gt;\n  ...</code></pre>
<ul>
<li><code>p.paragraph</code> analogously takes every <code>&lt;p&gt;</code> element which is of <code>class</code> “paragraph”.</li>
</ul>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="day3.html#cb90-1" aria-hidden="true" tabindex="-1"></a>basic_html <span class="sc">%&gt;%</span> <span class="fu">html_elements</span>(<span class="at">css =</span> <span class="st">&quot;p.paragraph&quot;</span>)</span></code></pre></div>
<pre><code>## {xml_nodeset (1)}
## [1] &lt;p class=&quot;paragraph&quot;&gt;Some text &amp;amp; &lt;b&gt;some bold text.&lt;/b&gt;&lt;/p&gt;</code></pre>
<ul>
<li><code>#link</code> scrapes elements that are of <code>id</code> “link”</li>
</ul>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="day3.html#cb92-1" aria-hidden="true" tabindex="-1"></a>basic_html <span class="sc">%&gt;%</span> <span class="fu">html_elements</span>(<span class="at">css =</span> <span class="st">&quot;#link&quot;</span>)</span></code></pre></div>
<pre><code>## {xml_nodeset (1)}
## [1] &lt;a id=&quot;link&quot; href=&quot;www.nyt.com&quot;&gt; The New York Times &lt;/a&gt;</code></pre>
<p>You can also connect children with their parents by using the <code></code> combinator. For instance, to extract the italicized text from “a.paragraph,” I can do “a.paragraph i”.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="day3.html#cb94-1" aria-hidden="true" tabindex="-1"></a>basic_html <span class="sc">%&gt;%</span> <span class="fu">html_elements</span>(<span class="at">css =</span> <span class="st">&quot;a.paragraph i&quot;</span>)</span></code></pre></div>
<pre><code>## {xml_nodeset (1)}
## [1] &lt;i&gt;some italicized text.&lt;/i&gt;</code></pre>
<p>You can also look at the children by using <code>html_children()</code>:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="day3.html#cb96-1" aria-hidden="true" tabindex="-1"></a>basic_html <span class="sc">%&gt;%</span> <span class="fu">html_elements</span>(<span class="at">css =</span> <span class="st">&quot;a.paragraph&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">html_children</span>()</span></code></pre></div>
<pre><code>## {xml_nodeset (1)}
## [1] &lt;i&gt;some italicized text.&lt;/i&gt;</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="day3.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_html</span>(<span class="st">&quot;https://rvest.tidyverse.org&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb98-2"><a href="day3.html#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_elements</span>(<span class="st">&quot;#installation , p&quot;</span>)</span></code></pre></div>
<pre><code>## {xml_nodeset (9)}
## [1] &lt;p&gt;rvest helps you scrape (or harvest) data from web pages. It is designe ...
## [2] &lt;p&gt;If you’re scraping multiple pages, I highly recommend using rvest in c ...
## [3] &lt;h2 id=&quot;installation&quot;&gt;Installation&lt;a class=&quot;anchor&quot; aria-label=&quot;anchor&quot; h ...
## [4] &lt;p&gt;If the page contains tabular data you can convert it directly to a dat ...
## [5] &lt;p&gt;Please note that the rvest project is released with a &lt;a href=&quot;https:/ ...
## [6] &lt;p&gt;&lt;/p&gt;
## [7] &lt;p&gt;Developed by &lt;a href=&quot;http://hadley.nz&quot; class=&quot;external-link&quot;&gt;Hadley W ...
## [8] &lt;p&gt;&lt;/p&gt;
## [9] &lt;p&gt;Site built with &lt;a href=&quot;https://pkgdown.r-lib.org/&quot; class=&quot;external-l ...</code></pre>
<p>Unfortunately, web pages in the wild are usually not as easily readable as the small example one I came up with. Hence, I would recommend you to use the <a href="javascript:(function()%7Bvar%20s=document.createElement(&#39;div&#39;);s.innerHTML=&#39;Loading...&#39;;s.style.color=&#39;black&#39;;s.style.padding=&#39;20px&#39;;s.style.position=&#39;fixed&#39;;s.style.zIndex=&#39;9999&#39;;s.style.fontSize=&#39;3.0em&#39;;s.style.border=&#39;2px%20solid%20black&#39;;s.style.right=&#39;40px&#39;;s.style.top=&#39;40px&#39;;s.setAttribute(&#39;class&#39;,&#39;selector_gadget_loading&#39;);s.style.background=&#39;white&#39;;document.body.appendChild(s);s=document.createElement(&#39;script&#39;);s.setAttribute(&#39;type&#39;,&#39;text/javascript&#39;);s.setAttribute(&#39;src&#39;,&#39;https://dv0akt2986vzh.cloudfront.net/unstable/lib/selectorgadget.js&#39;);document.body.appendChild(s);%7D)();">SelectorGadget</a> – just drag it into your bookmarks list.</p>
<p>Its usage could hardly be simpler:</p>
<ol style="list-style-type: decimal">
<li>Activate it – i.e., click on the bookmark.</li>
<li>Click on the content you want to scrape – the things the CSS selector selects will appear green.</li>
<li>Click on the green things that you don’t want – they will turn red; click on what’s not green yet but what you want – it will turn green.</li>
<li>copy the CSS selector the gadget provides you with and paste it into the <code>html_elements()</code> function.</li>
</ol>
</div>
<div id="scraping-html-pages-with-rvest" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Scraping HTML pages with <code>rvest</code><a href="day3.html#scraping-html-pages-with-rvest" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far, I have shown you how HTML is written and how to select elements. However, what we want to achieve is extracting the data the elements contained in a proper format and storing it in some sort of tibble. Therefore, we need functions that allow us to grab the data.</p>
<p>The following overview taken from the <a href="https://github.com/yusuzech/r-web-scraping-cheat-sheet">web scraping cheatsheet</a> shows you the basic “flow” of scraping web pages plus the corresponding functions. In this tutorial, I will limit myself to <code>rvest</code> functions. Those are of course perfectly compatible with things, for instance, <code>RSelenium</code>, as long as you feed the content in XML format (i.e., by using <code>read_html()</code>).</p>
<p><img src="https://raw.githubusercontent.com/yusuzech/r-web-scraping-cheat-sheet/master/resources/functions_and_classes.png" /></p>
<p>In the first part, I will introduce you to scraping singular pages and extracting their contents. <code>rvest</code> also allows for proper sessions where you navigate on the web pages and fill out forms. This is to be introduced in the second part.</p>
<div id="html_text-and-html_text2" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> <code>html_text()</code> and <code>html_text2()</code><a href="day3.html#html_text-and-html_text2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Extracting text from HTML is easy. You use <code>html_text()</code> or <code>html_text2()</code>. The former is faster but will give you not-so-nice results. The latter will give you the text like it would be returned in a web browser.</p>
<p>The following example is taken from <a href="https://rvest.tidyverse.org/reference/html_text.html">the documentation</a></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="day3.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># To understand the difference between html_text() and html_text2()</span></span>
<span id="cb100-2"><a href="day3.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="co"># take the following html:</span></span>
<span id="cb100-3"><a href="day3.html#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="day3.html#cb100-4" aria-hidden="true" tabindex="-1"></a>html <span class="ot">&lt;-</span> <span class="fu">minimal_html</span>(</span>
<span id="cb100-5"><a href="day3.html#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;&lt;p&gt;This is a paragraph.</span></span>
<span id="cb100-6"><a href="day3.html#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="st">    This is another sentence.&lt;br&gt;This should start on a new line&quot;</span></span>
<span id="cb100-7"><a href="day3.html#cb100-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="day3.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># html_text() returns the raw underlying text, which includes white space</span></span>
<span id="cb101-2"><a href="day3.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="co"># that would be ignored by a browser, and ignores the &lt;br&gt;</span></span>
<span id="cb101-3"><a href="day3.html#cb101-3" aria-hidden="true" tabindex="-1"></a>html <span class="sc">%&gt;%</span> <span class="fu">html_element</span>(<span class="st">&quot;p&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">html_text</span>() <span class="sc">%&gt;%</span> <span class="fu">writeLines</span>()</span></code></pre></div>
<pre><code>## This is a paragraph.
##     This is another sentence.This should start on a new line</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="day3.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># html_text2() simulates what a browser would display. Non-significant</span></span>
<span id="cb103-2"><a href="day3.html#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="co"># white space is collapsed, and &lt;br&gt; is turned into a line break</span></span>
<span id="cb103-3"><a href="day3.html#cb103-3" aria-hidden="true" tabindex="-1"></a>html <span class="sc">%&gt;%</span> <span class="fu">html_element</span>(<span class="st">&quot;p&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">html_text2</span>() <span class="sc">%&gt;%</span> <span class="fu">writeLines</span>()</span></code></pre></div>
<pre><code>## This is a paragraph. This is another sentence.
## This should start on a new line</code></pre>
<p>A “real example” would then look like this:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="day3.html#cb105-1" aria-hidden="true" tabindex="-1"></a>us_senators <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;https://en.wikipedia.org/wiki/List_of_current_United_States_senators&quot;</span>)</span>
<span id="cb105-2"><a href="day3.html#cb105-2" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span> us_senators <span class="sc">%&gt;%</span></span>
<span id="cb105-3"><a href="day3.html#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_elements</span>(<span class="at">css =</span> <span class="st">&quot;p:nth-child(6)&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb105-4"><a href="day3.html#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text2</span>()</span></code></pre></div>
</div>
<div id="extracting-tables" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Extracting tables<a href="day3.html#extracting-tables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The general output format we strive for is a tibble. Oftentimes, data is already stored online in a table format, basically ready for us to analyze them. In the next example, I want to get a table from the Wikipedia page that contains the senators of different States in the United States I have used before. For this first, basic example, I do not use selectors for extracting the right table. You can use <code>rvest::html_table()</code>. It will give you a list containing all tables on this particular page. We can inspect it using <code>str()</code> which returns an overview of the list and the tibbles it contains.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="day3.html#cb106-1" aria-hidden="true" tabindex="-1"></a>tables <span class="ot">&lt;-</span> us_senators <span class="sc">%&gt;%</span> </span>
<span id="cb106-2"><a href="day3.html#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_table</span>()</span>
<span id="cb106-3"><a href="day3.html#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="day3.html#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(tables)</span></code></pre></div>
<pre><code>## List of 22
##  $ : tibble [4 × 3] (S3: tbl_df/tbl/data.frame)
##   ..$ Affiliation: chr [1:4] &quot;&quot; &quot;&quot; &quot;&quot; &quot;Total&quot;
##   ..$ Affiliation: chr [1:4] &quot;Republican Party&quot; &quot;Democratic Party&quot; &quot;Independent&quot; &quot;Total&quot;
##   ..$ Members    : chr [1:4] &quot;50&quot; &quot;48&quot; &quot;2[a]&quot; &quot;100&quot;
##  $ : tibble [11 × 1] (S3: tbl_df/tbl/data.frame)
##   ..$ X1: chr [1:11] &quot;This article is part of a series on the&quot; &quot;United States Senate&quot; &quot;&quot; &quot;History of the United States Senate&quot; ...
##  $ : tibble [2 × 6] (S3: tbl_df/tbl/data.frame)
##   ..$ Office : chr [1:2] &quot;President of the Senate[b]&quot; &quot;President pro tempore&quot;
##   ..$ Party  : chr [1:2] &quot;Democratic&quot; &quot;Democratic&quot;
##   ..$ Officer: logi [1:2] NA NA
##   ..$ Officer: chr [1:2] &quot;Kamala Harris&quot; &quot;Patrick Leahy&quot;
##   ..$ State  : chr [1:2] &quot;CA[c]&quot; &quot;VT&quot;
##   ..$ Since  : chr [1:2] &quot;January 20, 2021&quot; &quot;January 20, 2021Party dean since December 17, 2012&quot;
##  $ : tibble [15 × 4] (S3: tbl_df/tbl/data.frame)
##   ..$ Office : chr [1:15] &quot;Senate Majority LeaderChair, Senate Democratic Caucus&quot; &quot;Senate Majority Whip&quot; &quot;Senate Assistant Democratic Leader&quot; &quot;Chair, Senate Democratic Policy and Communications Committee&quot; ...
##   ..$ Officer: chr [1:15] &quot;Chuck Schumer&quot; &quot;Dick Durbin&quot; &quot;Patty Murray&quot; &quot;Debbie Stabenow&quot; ...
##   ..$ State  : chr [1:15] &quot;NY&quot; &quot;IL&quot; &quot;WA&quot; &quot;MI&quot; ...
##   ..$ Since  : chr [1:15] &quot;January 20, 2021Party leader since January 3, 2017&quot; &quot;January 20, 2021Party whip since January 3, 2005&quot; &quot;January 3, 2017&quot; &quot;January 3, 2017&quot; ...
##  $ : tibble [9 × 4] (S3: tbl_df/tbl/data.frame)
##   ..$ Office : chr [1:9] &quot;Senate Minority Leader&quot; &quot;Senate Minority Whip&quot; &quot;Chair, Senate Republican Conference&quot; &quot;Chair, Senate Republican Policy Committee&quot; ...
##   ..$ Officer: chr [1:9] &quot;Mitch McConnell&quot; &quot;John Thune&quot; &quot;John Barrasso&quot; &quot;Roy Blunt&quot; ...
##   ..$ State  : chr [1:9] &quot;KY&quot; &quot;SD&quot; &quot;WY&quot; &quot;MO&quot; ...
##   ..$ Since  : chr [1:9] &quot;January 20, 2021Party leader since January 3, 2007&quot; &quot;January 20, 2021Party whip since January 3, 2019&quot; &quot;January 3, 2019&quot; &quot;January 3, 2019&quot; ...
##  $ : tibble [100 × 12] (S3: tbl_df/tbl/data.frame)
##   ..$ State                     : chr [1:100] &quot;Alabama&quot; &quot;Alabama&quot; &quot;Alaska&quot; &quot;Alaska&quot; ...
##   ..$ Portrait                  : logi [1:100] NA NA NA NA NA NA ...
##   ..$ Senator                   : chr [1:100] &quot;Richard Shelby&quot; &quot;Tommy Tuberville&quot; &quot;Lisa Murkowski&quot; &quot;Dan Sullivan&quot; ...
##   ..$ Party                     : logi [1:100] NA NA NA NA NA NA ...
##   ..$ Party                     : chr [1:100] &quot;Republican[d]&quot; &quot;Republican&quot; &quot;Republican&quot; &quot;Republican&quot; ...
##   ..$ Born                      : chr [1:100] &quot;(1934-05-06) May 6, 1934 (age 88)&quot; &quot;(1954-09-18) September 18, 1954 (age 67)&quot; &quot;(1957-05-22) May 22, 1957 (age 65)&quot; &quot;(1964-11-13) November 13, 1964 (age 57)&quot; ...
##   ..$ Occupation(s)             : chr [1:100] &quot;Lawyer&quot; &quot;College football coachPartner, investment management firm&quot; &quot;Lawyer&quot; &quot;U.S. Marine Corps officerLawyerAssistant Secretary of State for Economic and Business Affairs&quot; ...
##   ..$ Previous electiveoffice(s): chr [1:100] &quot;U.S. HouseAlabama Senate&quot; &quot;None&quot; &quot;Alaska House of Representatives&quot; &quot;Alaska Attorney General&quot; ...
##   ..$ Education                 : chr [1:100] &quot;University of Alabama (BA, LLB)\nBirmingham School of Law (JD)&quot; &quot;Southern Arkansas University (BS)&quot; &quot;Georgetown University (AB)\nWillamette University (JD)&quot; &quot;Harvard University (AB)\nGeorgetown University (MS, JD)&quot; ...
##   ..$ Assumed office            : chr [1:100] &quot;January 3, 1987&quot; &quot;January 3, 2021&quot; &quot;December 20, 2002[e]&quot; &quot;January 3, 2015&quot; ...
##   ..$ Class                     : chr [1:100] &quot;2022Class 3&quot; &quot;2026Class 2&quot; &quot;2022Class 3&quot; &quot;2026Class 2&quot; ...
##   ..$ Residence[2]              : chr [1:100] &quot;Tuscaloosa&quot; &quot;Auburn[3]&quot; &quot;Girdwood&quot; &quot;Anchorage&quot; ...
##  $ : tibble [3 × 3] (S3: tbl_df/tbl/data.frame)
##   ..$ vteCurrent United States senators: chr [1:3] &quot;President: ▌ Kamala Harris (D) ‧ President pro tempore: ▌ Patrick Leahy (D)&quot; &quot;.mw-parser-output .div-col{margin-top:0.3em;column-width:30em}.mw-parser-output .div-col-small{font-size:90%}.m&quot;| __truncated__ &quot;▌ Republican: 50\n▌ Democratic: 48\n▌ Independent: 2&quot;
##   ..$ vteCurrent United States senators: chr [1:3] &quot;President: ▌ Kamala Harris (D) ‧ President pro tempore: ▌ Patrick Leahy (D)&quot; &quot;.mw-parser-output .div-col{margin-top:0.3em;column-width:30em}.mw-parser-output .div-col-small{font-size:90%}.m&quot;| __truncated__ &quot;▌ Republican: 50\n▌ Democratic: 48\n▌ Independent: 2&quot;
##   ..$ vteCurrent United States senators: chr [1:3] &quot;President: ▌ Kamala Harris (D) ‧ President pro tempore: ▌ Patrick Leahy (D)&quot; &quot;&quot; &quot;▌ Republican: 50\n▌ Democratic: 48\n▌ Independent: 2&quot;
##  $ : tibble [49 × 36] (S3: tbl_df/tbl/data.frame)
##   ..$ vteUnited States Congress: chr [1:49] &quot;House of Representatives\nSenate\nJoint session\n(116th ← 117th → 118th)\nLists of United States Congress&quot; &quot;Members and leadersMembershipMembers\nBy length of service\nBy shortness of service\nFreshmen\nYoungest members&quot;| __truncated__ &quot;Members and leaders&quot; &quot;MembershipMembers\nBy length of service\nBy shortness of service\nFreshmen\nYoungest members\nNon-voting member&quot;| __truncated__ ...
##   ..$ vteUnited States Congress: chr [1:49] &quot;House of Representatives\nSenate\nJoint session\n(116th ← 117th → 118th)\nLists of United States Congress&quot; &quot;Members and leadersMembershipMembers\nBy length of service\nBy shortness of service\nFreshmen\nYoungest members&quot;| __truncated__ &quot;Members and leaders&quot; &quot;MembershipMembers\nBy length of service\nBy shortness of service\nFreshmen\nYoungest members\nNon-voting member&quot;| __truncated__ ...
##   ..$                          : chr [1:49] NA &quot;Members and leaders&quot; NA &quot;Membership&quot; ...
##   ..$                          : chr [1:49] NA &quot;Members and leaders&quot; NA &quot;Members\nBy length of service\nBy shortness of service\nFreshmen\nYoungest members\nNon-voting members\nUnseate&quot;| __truncated__ ...
##   ..$                          : chr [1:49] NA &quot;MembershipMembers\nBy length of service\nBy shortness of service\nFreshmen\nYoungest members\nNon-voting member&quot;| __truncated__ NA &quot;Members&quot; ...
##   ..$                          : chr [1:49] NA &quot;MembershipMembers\nBy length of service\nBy shortness of service\nFreshmen\nYoungest members\nNon-voting member&quot;| __truncated__ NA &quot;By length of service\nBy shortness of service\nFreshmen\nYoungest members\nNon-voting members\nUnseated members&quot; ...
##   ..$                          : chr [1:49] NA &quot;Membership&quot; NA &quot;Senate&quot; ...
##   ..$                          : chr [1:49] NA &quot;Members\nBy length of service\nBy shortness of service\nFreshmen\nYoungest members\nNon-voting members\nUnseate&quot;| __truncated__ NA &quot;Members\nseniority\nDean\nFormer\nExpelled or censured\nClasses\nBorn outside the U.S.\nResigned\nAppointed\nSwitched parties&quot; ...
##   ..$                          : chr [1:49] NA &quot;Members&quot; NA &quot;House&quot; ...
##   ..$                          : chr [1:49] NA &quot;By length of service\nBy shortness of service\nFreshmen\nYoungest members\nNon-voting members\nUnseated members&quot; NA &quot;Members\nseniority\nDean\nFormer\nExpelled, censured, and reprimanded\nServed a single term\nSwitched parties\n&quot;| __truncated__ ...
##   ..$                          : chr [1:49] NA &quot;Senate&quot; NA &quot;Leaders&quot; ...
##   ..$                          : chr [1:49] NA &quot;Members\nseniority\nDean\nFormer\nExpelled or censured\nClasses\nBorn outside the U.S.\nResigned\nAppointed\nSwitched parties&quot; NA &quot;Senate\nPresident\nlist\nPresident pro tempore\nlist\nLeaders\nDemocratic Caucus\nChair\nSecretary\nPolicy Comm&quot;| __truncated__ ...
##   ..$                          : chr [1:49] NA &quot;House&quot; NA &quot;Senate&quot; ...
##   ..$                          : chr [1:49] NA &quot;Members\nseniority\nDean\nFormer\nExpelled, censured, and reprimanded\nServed a single term\nSwitched parties\n&quot;| __truncated__ NA &quot;President\nlist\nPresident pro tempore\nlist\nLeaders\nDemocratic Caucus\nChair\nSecretary\nPolicy Committee Ch&quot;| __truncated__ ...
##   ..$                          : chr [1:49] NA &quot;Leaders&quot; NA &quot;House&quot; ...
##   ..$                          : chr [1:49] NA &quot;Senate\nPresident\nlist\nPresident pro tempore\nlist\nLeaders\nDemocratic Caucus\nChair\nSecretary\nPolicy Comm&quot;| __truncated__ NA &quot;Speaker\nlist\nLeaders\nBipartisan Legal Advisory Group\nDemocratic Caucus\nRepublican Conference&quot; ...
##   ..$                          : chr [1:49] NA &quot;Senate&quot; NA &quot;Districts&quot; ...
##   ..$                          : chr [1:49] NA &quot;President\nlist\nPresident pro tempore\nlist\nLeaders\nDemocratic Caucus\nChair\nSecretary\nPolicy Committee Ch&quot;| __truncated__ NA &quot;List\nApportionment\nGerrymandering&quot; ...
##   ..$                          : chr [1:49] NA &quot;House&quot; NA &quot;Groups&quot; ...
##   ..$                          : chr [1:49] NA &quot;Speaker\nlist\nLeaders\nBipartisan Legal Advisory Group\nDemocratic Caucus\nRepublican Conference&quot; NA &quot;Congressional caucus\nCaucuses of the United States CongressEthnic and racial\nAfrican-American members\nSenate&quot;| __truncated__ ...
##   ..$                          : chr [1:49] NA &quot;Districts&quot; NA &quot;Congressional caucus&quot; ...
##   ..$                          : chr [1:49] NA &quot;List\nApportionment\nGerrymandering&quot; NA &quot;Caucuses of the United States Congress&quot; ...
##   ..$                          : chr [1:49] NA &quot;Groups&quot; NA &quot;Ethnic and racial&quot; ...
##   ..$                          : chr [1:49] NA &quot;Congressional caucus\nCaucuses of the United States CongressEthnic and racial\nAfrican-American members\nSenate&quot;| __truncated__ NA &quot;African-American members\nSenate\nHouse\nBlack Caucus\nArab and Middle Eastern members\nAsian Pacific American &quot;| __truncated__ ...
##   ..$                          : chr [1:49] NA &quot;Congressional caucus&quot; NA &quot;Gender and sexual identity&quot; ...
##   ..$                          : chr [1:49] NA &quot;Caucuses of the United States Congress&quot; NA &quot;LGBT members\nLGBT Equality Caucus\nWomen\nSenate\nHouse\nIssues Caucus\nCurrent House&quot; ...
##   ..$                          : chr [1:49] NA &quot;Ethnic and racial&quot; NA &quot;Occupation&quot; ...
##   ..$                          : chr [1:49] NA &quot;African-American members\nSenate\nHouse\nBlack Caucus\nArab and Middle Eastern members\nAsian Pacific American &quot;| __truncated__ NA &quot;Physicians&quot; ...
##   ..$                          : chr [1:49] NA &quot;Gender and sexual identity&quot; NA &quot;Religion&quot; ...
##   ..$                          : chr [1:49] NA &quot;LGBT members\nLGBT Equality Caucus\nWomen\nSenate\nHouse\nIssues Caucus\nCurrent House&quot; NA &quot;Buddhist members\nHindu members\nJewish members\nMormon (LDS) members\nMuslim members&quot; ...
##   ..$                          : chr [1:49] NA &quot;Occupation&quot; NA &quot;Related&quot; ...
##   ..$                          : chr [1:49] NA &quot;Physicians&quot; NA &quot;By length of service historically\nCurrent members by wealth\nFrom multiple states\nDied in office\n1790–1899\n&quot;| __truncated__ ...
##   ..$                          : chr [1:49] NA &quot;Religion&quot; NA NA ...
##   ..$                          : chr [1:49] NA &quot;Buddhist members\nHindu members\nJewish members\nMormon (LDS) members\nMuslim members&quot; NA NA ...
##   ..$                          : chr [1:49] NA &quot;Related&quot; NA NA ...
##   ..$                          : chr [1:49] NA &quot;By length of service historically\nCurrent members by wealth\nFrom multiple states\nDied in office\n1790–1899\n&quot;| __truncated__ NA NA ...
##  $ : tibble [16 × 32] (S3: tbl_df/tbl/data.frame)
##   ..$ Members and leaders: chr [1:16] &quot;MembershipMembers\nBy length of service\nBy shortness of service\nFreshmen\nYoungest members\nNon-voting member&quot;| __truncated__ &quot;Membership&quot; &quot;Members&quot; &quot;Senate&quot; ...
##   ..$ Members and leaders: chr [1:16] &quot;MembershipMembers\nBy length of service\nBy shortness of service\nFreshmen\nYoungest members\nNon-voting member&quot;| __truncated__ &quot;Members\nBy length of service\nBy shortness of service\nFreshmen\nYoungest members\nNon-voting members\nUnseate&quot;| __truncated__ &quot;By length of service\nBy shortness of service\nFreshmen\nYoungest members\nNon-voting members\nUnseated members&quot; &quot;Members\nseniority\nDean\nFormer\nExpelled or censured\nClasses\nBorn outside the U.S.\nResigned\nAppointed\nSwitched parties&quot; ...
##   ..$                    : chr [1:16] &quot;Membership&quot; &quot;Members&quot; NA NA ...
##   ..$                    : chr [1:16] &quot;Members\nBy length of service\nBy shortness of service\nFreshmen\nYoungest members\nNon-voting members\nUnseate&quot;| __truncated__ &quot;By length of service\nBy shortness of service\nFreshmen\nYoungest members\nNon-voting members\nUnseated members&quot; NA NA ...
##   ..$                    : chr [1:16] &quot;Members&quot; &quot;Senate&quot; NA NA ...
##   ..$                    : chr [1:16] &quot;By length of service\nBy shortness of service\nFreshmen\nYoungest members\nNon-voting members\nUnseated members&quot; &quot;Members\nseniority\nDean\nFormer\nExpelled or censured\nClasses\nBorn outside the U.S.\nResigned\nAppointed\nSwitched parties&quot; NA NA ...
##   ..$                    : chr [1:16] &quot;Senate&quot; &quot;House&quot; NA NA ...
##   ..$                    : chr [1:16] &quot;Members\nseniority\nDean\nFormer\nExpelled or censured\nClasses\nBorn outside the U.S.\nResigned\nAppointed\nSwitched parties&quot; &quot;Members\nseniority\nDean\nFormer\nExpelled, censured, and reprimanded\nServed a single term\nSwitched parties\n&quot;| __truncated__ NA NA ...
##   ..$                    : chr [1:16] &quot;House&quot; NA NA NA ...
##   ..$                    : chr [1:16] &quot;Members\nseniority\nDean\nFormer\nExpelled, censured, and reprimanded\nServed a single term\nSwitched parties\n&quot;| __truncated__ NA NA NA ...
##   ..$                    : chr [1:16] &quot;Leaders&quot; NA NA NA ...
##   ..$                    : chr [1:16] &quot;Senate\nPresident\nlist\nPresident pro tempore\nlist\nLeaders\nDemocratic Caucus\nChair\nSecretary\nPolicy Comm&quot;| __truncated__ NA NA NA ...
##   ..$                    : chr [1:16] &quot;Senate&quot; NA NA NA ...
##   ..$                    : chr [1:16] &quot;President\nlist\nPresident pro tempore\nlist\nLeaders\nDemocratic Caucus\nChair\nSecretary\nPolicy Committee Ch&quot;| __truncated__ NA NA NA ...
##   ..$                    : chr [1:16] &quot;House&quot; NA NA NA ...
##   ..$                    : chr [1:16] &quot;Speaker\nlist\nLeaders\nBipartisan Legal Advisory Group\nDemocratic Caucus\nRepublican Conference&quot; NA NA NA ...
##   ..$                    : chr [1:16] &quot;Districts&quot; NA NA NA ...
##   ..$                    : chr [1:16] &quot;List\nApportionment\nGerrymandering&quot; NA NA NA ...
##   ..$                    : chr [1:16] &quot;Groups&quot; NA NA NA ...
##   ..$                    : chr [1:16] &quot;Congressional caucus\nCaucuses of the United States CongressEthnic and racial\nAfrican-American members\nSenate&quot;| __truncated__ NA NA NA ...
##   ..$                    : chr [1:16] &quot;Congressional caucus&quot; NA NA NA ...
##   ..$                    : chr [1:16] &quot;Caucuses of the United States Congress&quot; NA NA NA ...
##   ..$                    : chr [1:16] &quot;Ethnic and racial&quot; NA NA NA ...
##   ..$                    : chr [1:16] &quot;African-American members\nSenate\nHouse\nBlack Caucus\nArab and Middle Eastern members\nAsian Pacific American &quot;| __truncated__ NA NA NA ...
##   ..$                    : chr [1:16] &quot;Gender and sexual identity&quot; NA NA NA ...
##   ..$                    : chr [1:16] &quot;LGBT members\nLGBT Equality Caucus\nWomen\nSenate\nHouse\nIssues Caucus\nCurrent House&quot; NA NA NA ...
##   ..$                    : chr [1:16] &quot;Occupation&quot; NA NA NA ...
##   ..$                    : chr [1:16] &quot;Physicians&quot; NA NA NA ...
##   ..$                    : chr [1:16] &quot;Religion&quot; NA NA NA ...
##   ..$                    : chr [1:16] &quot;Buddhist members\nHindu members\nJewish members\nMormon (LDS) members\nMuslim members&quot; NA NA NA ...
##   ..$                    : chr [1:16] &quot;Related&quot; NA NA NA ...
##   ..$                    : chr [1:16] &quot;By length of service historically\nCurrent members by wealth\nFrom multiple states\nDied in office\n1790–1899\n&quot;| __truncated__ NA NA NA ...
##  $ : tibble [15 × 12] (S3: tbl_df/tbl/data.frame)
##   ..$ X1 : chr [1:15] &quot;Membership&quot; &quot;Members&quot; &quot;Senate&quot; &quot;House&quot; ...
##   ..$ X2 : chr [1:15] &quot;Members\nBy length of service\nBy shortness of service\nFreshmen\nYoungest members\nNon-voting members\nUnseate&quot;| __truncated__ &quot;By length of service\nBy shortness of service\nFreshmen\nYoungest members\nNon-voting members\nUnseated members&quot; &quot;Members\nseniority\nDean\nFormer\nExpelled or censured\nClasses\nBorn outside the U.S.\nResigned\nAppointed\nSwitched parties&quot; &quot;Members\nseniority\nDean\nFormer\nExpelled, censured, and reprimanded\nServed a single term\nSwitched parties\n&quot;| __truncated__ ...
##   ..$ X3 : chr [1:15] &quot;Members&quot; NA NA NA ...
##   ..$ X4 : chr [1:15] &quot;By length of service\nBy shortness of service\nFreshmen\nYoungest members\nNon-voting members\nUnseated members&quot; NA NA NA ...
##   ..$ X5 : chr [1:15] &quot;Senate&quot; NA NA NA ...
##   ..$ X6 : chr [1:15] &quot;Members\nseniority\nDean\nFormer\nExpelled or censured\nClasses\nBorn outside the U.S.\nResigned\nAppointed\nSwitched parties&quot; NA NA NA ...
##   ..$ X7 : chr [1:15] &quot;House&quot; NA NA NA ...
##   ..$ X8 : chr [1:15] &quot;Members\nseniority\nDean\nFormer\nExpelled, censured, and reprimanded\nServed a single term\nSwitched parties\n&quot;| __truncated__ NA NA NA ...
##   ..$ X9 : chr [1:15] NA NA NA NA ...
##   ..$ X10: chr [1:15] NA NA NA NA ...
##   ..$ X11: chr [1:15] NA NA NA NA ...
##   ..$ X12: chr [1:15] NA NA NA NA ...
##  $ : tibble [3 × 2] (S3: tbl_df/tbl/data.frame)
##   ..$ X1: chr [1:3] &quot;Members&quot; &quot;Senate&quot; &quot;House&quot;
##   ..$ X2: chr [1:3] &quot;By length of service\nBy shortness of service\nFreshmen\nYoungest members\nNon-voting members\nUnseated members&quot; &quot;Members\nseniority\nDean\nFormer\nExpelled or censured\nClasses\nBorn outside the U.S.\nResigned\nAppointed\nSwitched parties&quot; &quot;Members\nseniority\nDean\nFormer\nExpelled, censured, and reprimanded\nServed a single term\nSwitched parties\n&quot;| __truncated__
##  $ : tibble [2 × 2] (S3: tbl_df/tbl/data.frame)
##   ..$ X1: chr [1:2] &quot;Senate&quot; &quot;House&quot;
##   ..$ X2: chr [1:2] &quot;President\nlist\nPresident pro tempore\nlist\nLeaders\nDemocratic Caucus\nChair\nSecretary\nPolicy Committee Ch&quot;| __truncated__ &quot;Speaker\nlist\nLeaders\nBipartisan Legal Advisory Group\nDemocratic Caucus\nRepublican Conference&quot;
##  $ : tibble [5 × 2] (S3: tbl_df/tbl/data.frame)
##   ..$ X1: chr [1:5] &quot;Congressional caucus&quot; &quot;Ethnic and racial&quot; &quot;Gender and sexual identity&quot; &quot;Occupation&quot; ...
##   ..$ X2: chr [1:5] &quot;Caucuses of the United States Congress&quot; &quot;African-American members\nSenate\nHouse\nBlack Caucus\nArab and Middle Eastern members\nAsian Pacific American &quot;| __truncated__ &quot;LGBT members\nLGBT Equality Caucus\nWomen\nSenate\nHouse\nIssues Caucus\nCurrent House&quot; &quot;Physicians&quot; ...
##  $ : tibble [10 × 20] (S3: tbl_df/tbl/data.frame)
##   ..$ Powers, privileges, procedure, committees, history, media: chr [1:10] &quot;Powers\nArticle I\nCopyright\nCommerce (Dormant)\nContempt of Congress\nDeclaration of war\nImpeachment\nNatura&quot;| __truncated__ &quot;Powers&quot; &quot;Privileges&quot; &quot;Procedure&quot; ...
##   ..$ Powers, privileges, procedure, committees, history, media: chr [1:10] &quot;Powers\nArticle I\nCopyright\nCommerce (Dormant)\nContempt of Congress\nDeclaration of war\nImpeachment\nNatura&quot;| __truncated__ &quot;Article I\nCopyright\nCommerce (Dormant)\nContempt of Congress\nDeclaration of war\nImpeachment\nNaturalization&quot;| __truncated__ &quot;Salaries\nFranking\nImmunity&quot; &quot;Act of Congress\nlist\nAppropriation bill\nBill\nBlue slip\nBudget process\nCensure\nClosed sessions\nHouse\nSe&quot;| __truncated__ ...
##   ..$                                                          : chr [1:10] &quot;Powers&quot; NA NA NA ...
##   ..$                                                          : chr [1:10] &quot;Article I\nCopyright\nCommerce (Dormant)\nContempt of Congress\nDeclaration of war\nImpeachment\nNaturalization&quot;| __truncated__ NA NA NA ...
##   ..$                                                          : chr [1:10] &quot;Privileges&quot; NA NA NA ...
##   ..$                                                          : chr [1:10] &quot;Salaries\nFranking\nImmunity&quot; NA NA NA ...
##   ..$                                                          : chr [1:10] &quot;Procedure&quot; NA NA NA ...
##   ..$                                                          : chr [1:10] &quot;Act of Congress\nlist\nAppropriation bill\nBill\nBlue slip\nBudget process\nCensure\nClosed sessions\nHouse\nSe&quot;| __truncated__ NA NA NA ...
##   ..$                                                          : chr [1:10] &quot;Senate-specific&quot; NA NA NA ...
##   ..$                                                          : chr [1:10] &quot;Advice and consent\nClasses\nExecutive communication\nExecutive session\nFilibuster\nJefferson&#39;s Manual\nSenate&quot;| __truncated__ NA NA NA ...
##   ..$                                                          : chr [1:10] &quot;Committees&quot; NA NA NA ...
##   ..$                                                          : chr [1:10] &quot;Chairman and ranking member\nOf the Whole\nConference\nDischarge petition\nHearings\nMarkup\nOversight\nList (J&quot;| __truncated__ NA NA NA ...
##   ..$                                                          : chr [1:10] &quot;Items&quot; NA NA NA ...
##   ..$                                                          : chr [1:10] &quot;Gavels\nMace of the House\nSeal of the Senate&quot; NA NA NA ...
##   ..$                                                          : chr [1:10] &quot;History&quot; NA NA NA ...
##   ..$                                                          : chr [1:10] &quot;House history\nMemoirs\nSpeaker elections\nSenate history\nElection disputes\nMemoirs\nContinental Congress\nFe&quot;| __truncated__ NA NA NA ...
##   ..$                                                          : chr [1:10] &quot;House history\nMemoirs\nSpeaker elections\nSenate history\nElection disputes\nMemoirs\nContinental Congress\nFe&quot;| __truncated__ NA NA NA ...
##   ..$                                                          : chr [1:10] &quot;House history\nMemoirs\nSpeaker elections\nSenate history\nElection disputes\nMemoirs\nContinental Congress\nFe&quot;| __truncated__ NA NA NA ...
##   ..$                                                          : chr [1:10] &quot;Media&quot; NA NA NA ...
##   ..$                                                          : chr [1:10] &quot;C-SPAN\nCongressional Quarterly\nThe Hill\nPolitico\nRoll Call&quot; NA NA NA ...
##  $ : tibble [9 × 4] (S3: tbl_df/tbl/data.frame)
##   ..$ X1: chr [1:9] &quot;Powers&quot; &quot;Privileges&quot; &quot;Procedure&quot; &quot;Senate-specific&quot; ...
##   ..$ X2: chr [1:9] &quot;Article I\nCopyright\nCommerce (Dormant)\nContempt of Congress\nDeclaration of war\nImpeachment\nNaturalization&quot;| __truncated__ &quot;Salaries\nFranking\nImmunity&quot; &quot;Act of Congress\nlist\nAppropriation bill\nBill\nBlue slip\nBudget process\nCensure\nClosed sessions\nHouse\nSe&quot;| __truncated__ &quot;Advice and consent\nClasses\nExecutive communication\nExecutive session\nFilibuster\nJefferson&#39;s Manual\nSenate&quot;| __truncated__ ...
##   ..$ X3: chr [1:9] NA NA NA NA ...
##   ..$ X4: chr [1:9] NA NA NA NA ...
##  $ : tibble [1 × 2] (S3: tbl_df/tbl/data.frame)
##   ..$ X1: chr &quot;House history\nMemoirs\nSpeaker elections\nSenate history\nElection disputes\nMemoirs\nContinental Congress\nFe&quot;| __truncated__
##   ..$ X2: chr &quot;House history\nMemoirs\nSpeaker elections\nSenate history\nElection disputes\nMemoirs\nContinental Congress\nFe&quot;| __truncated__
##  $ : tibble [16 × 32] (S3: tbl_df/tbl/data.frame)
##   ..$ Capitol Complex (Capitol Hill): chr [1:16] &quot;Legislativeoffices\nCongressional staff\nGov. Accountability Office (GAO)\nComptroller General\nArchitect of th&quot;| __truncated__ &quot;Legislativeoffices&quot; &quot;Offices&quot; &quot;Senate&quot; ...
##   ..$ Capitol Complex (Capitol Hill): chr [1:16] &quot;Legislativeoffices\nCongressional staff\nGov. Accountability Office (GAO)\nComptroller General\nArchitect of th&quot;| __truncated__ &quot;Congressional staff\nGov. Accountability Office (GAO)\nComptroller General\nArchitect of the Capitol\nCap. Poli&quot;| __truncated__ &quot;Senate\nCurator\nHistorical\nLibraryHouse\nCongr. Ethics\nEmergency Planning, Preparedness, and Operations\nInt&quot;| __truncated__ &quot;Curator\nHistorical\nLibrary&quot; ...
##   ..$                               : chr [1:16] &quot;Legislativeoffices&quot; NA &quot;Senate&quot; NA ...
##   ..$                               : chr [1:16] &quot;Congressional staff\nGov. Accountability Office (GAO)\nComptroller General\nArchitect of the Capitol\nCap. Poli&quot;| __truncated__ NA &quot;Curator\nHistorical\nLibrary&quot; NA ...
##   ..$                               : chr [1:16] &quot;Offices&quot; NA &quot;House&quot; NA ...
##   ..$                               : chr [1:16] &quot;Senate\nCurator\nHistorical\nLibraryHouse\nCongr. Ethics\nEmergency Planning, Preparedness, and Operations\nInt&quot;| __truncated__ NA &quot;Congr. Ethics\nEmergency Planning, Preparedness, and Operations\nInterparliamentary Affairs\nLaw Revision Couns&quot;| __truncated__ NA ...
##   ..$                               : chr [1:16] &quot;Senate&quot; NA NA NA ...
##   ..$                               : chr [1:16] &quot;Curator\nHistorical\nLibrary&quot; NA NA NA ...
##   ..$                               : chr [1:16] &quot;House&quot; NA NA NA ...
##   ..$                               : chr [1:16] &quot;Congr. Ethics\nEmergency Planning, Preparedness, and Operations\nInterparliamentary Affairs\nLaw Revision Couns&quot;| __truncated__ NA NA NA ...
##   ..$                               : chr [1:16] &quot;Employees&quot; NA NA NA ...
##   ..$                               : chr [1:16] &quot;Senate\nSecretary\nChaplain\nCurator\nHistorian\nLibrarian\nPages\nParliamentarian\nSergeant at Arms and Doorke&quot;| __truncated__ NA NA NA ...
##   ..$                               : chr [1:16] &quot;Senate&quot; NA NA NA ...
##   ..$                               : chr [1:16] &quot;Secretary\nChaplain\nCurator\nHistorian\nLibrarian\nPages\nParliamentarian\nSergeant at Arms and Doorkeeper&quot; NA NA NA ...
##   ..$                               : chr [1:16] &quot;House&quot; NA NA NA ...
##   ..$                               : chr [1:16] &quot;Chaplain\nChief Administrative Officer\nClerk\nDoorkeeper\nFloor Operations\nFloor Services Chief\nHistorian\nP&quot;| __truncated__ NA NA NA ...
##   ..$                               : chr [1:16] &quot;Library ofCongress&quot; NA NA NA ...
##   ..$                               : chr [1:16] &quot;Congressional Research Service\nReports\nCopyright Office\nRegister of Copyrights\nLaw Library\nPoet Laureate\n&quot;| __truncated__ NA NA NA ...
##   ..$                               : chr [1:16] &quot;Gov.Publishing Office&quot; NA NA NA ...
##   ..$                               : chr [1:16] &quot;Public Printer\nCongressional Pictorial Directory\nCongressional Record\nOfficial Congressional Directory\nU.S.&quot;| __truncated__ NA NA NA ...
##   ..$                               : chr [1:16] &quot;Capitol Building&quot; NA NA NA ...
##   ..$                               : chr [1:16] &quot;Brumidi Corridors\nCongressional Prayer Room\nCrypt\nDome\nStatue of Freedom\nRotunda\nHall of Columns\nStatuar&quot;| __truncated__ NA NA NA ...
##   ..$                               : chr [1:16] &quot;Officebuildings&quot; NA NA NA ...
##   ..$                               : chr [1:16] &quot;Senate\nDirksen\nHart\nMountains and Clouds\nRussellHouse\nBuilding Commission\nCannon\nFord\nLongworth\nO&#39;Neill\nRayburn&quot; NA NA NA ...
##   ..$                               : chr [1:16] &quot;Senate&quot; NA NA NA ...
##   ..$                               : chr [1:16] &quot;Dirksen\nHart\nMountains and Clouds\nRussell&quot; NA NA NA ...
##   ..$                               : chr [1:16] &quot;House&quot; NA NA NA ...
##   ..$                               : chr [1:16] &quot;Building Commission\nCannon\nFord\nLongworth\nO&#39;Neill\nRayburn&quot; NA NA NA ...
##   ..$                               : chr [1:16] &quot;Otherfacilities&quot; NA NA NA ...
##   ..$                               : chr [1:16] &quot;Botanic Garden\nHealth and Fitness Facility\nHouse Recording Studio\nSenate chamber\nOld Senate Chamber\nOld Su&quot;| __truncated__ NA NA NA ...
##   ..$                               : chr [1:16] &quot;Related&quot; NA NA NA ...
##   ..$                               : chr [1:16] &quot;Capitol Hill\nUnited States Capitol cornerstone laying&quot; NA NA NA ...
##  $ : tibble [15 × 6] (S3: tbl_df/tbl/data.frame)
##   ..$ X1: chr [1:15] &quot;Legislativeoffices&quot; &quot;Offices&quot; &quot;Senate&quot; &quot;House&quot; ...
##   ..$ X2: chr [1:15] &quot;Congressional staff\nGov. Accountability Office (GAO)\nComptroller General\nArchitect of the Capitol\nCap. Poli&quot;| __truncated__ &quot;Senate\nCurator\nHistorical\nLibraryHouse\nCongr. Ethics\nEmergency Planning, Preparedness, and Operations\nInt&quot;| __truncated__ &quot;Curator\nHistorical\nLibrary&quot; &quot;Congr. Ethics\nEmergency Planning, Preparedness, and Operations\nInterparliamentary Affairs\nLaw Revision Couns&quot;| __truncated__ ...
##   ..$ X3: chr [1:15] NA &quot;Senate&quot; NA NA ...
##   ..$ X4: chr [1:15] NA &quot;Curator\nHistorical\nLibrary&quot; NA NA ...
##   ..$ X5: chr [1:15] NA &quot;House&quot; NA NA ...
##   ..$ X6: chr [1:15] NA &quot;Congr. Ethics\nEmergency Planning, Preparedness, and Operations\nInterparliamentary Affairs\nLaw Revision Couns&quot;| __truncated__ NA NA ...
##  $ : tibble [2 × 2] (S3: tbl_df/tbl/data.frame)
##   ..$ X1: chr [1:2] &quot;Senate&quot; &quot;House&quot;
##   ..$ X2: chr [1:2] &quot;Curator\nHistorical\nLibrary&quot; &quot;Congr. Ethics\nEmergency Planning, Preparedness, and Operations\nInterparliamentary Affairs\nLaw Revision Couns&quot;| __truncated__
##  $ : tibble [2 × 2] (S3: tbl_df/tbl/data.frame)
##   ..$ X1: chr [1:2] &quot;Senate&quot; &quot;House&quot;
##   ..$ X2: chr [1:2] &quot;Secretary\nChaplain\nCurator\nHistorian\nLibrarian\nPages\nParliamentarian\nSergeant at Arms and Doorkeeper&quot; &quot;Chaplain\nChief Administrative Officer\nClerk\nDoorkeeper\nFloor Operations\nFloor Services Chief\nHistorian\nP&quot;| __truncated__
##  $ : tibble [2 × 2] (S3: tbl_df/tbl/data.frame)
##   ..$ X1: chr [1:2] &quot;Senate&quot; &quot;House&quot;
##   ..$ X2: chr [1:2] &quot;Dirksen\nHart\nMountains and Clouds\nRussell&quot; &quot;Building Commission\nCannon\nFord\nLongworth\nO&#39;Neill\nRayburn&quot;
##  $ : tibble [2 × 2] (S3: tbl_df/tbl/data.frame)
##   ..$ vteOrder of precedence in the United States*: chr [1:2] &quot;PresidentVice President\nGovernor (of the state in which the event is held)\nSpeaker of the House\nChief Justic&quot;| __truncated__ &quot;*not including acting officeholders, visiting dignitaries, auxiliary executive and military personnel and most diplomats&quot;
##   ..$ vteOrder of precedence in the United States*: chr [1:2] &quot;PresidentVice President\nGovernor (of the state in which the event is held)\nSpeaker of the House\nChief Justic&quot;| __truncated__ &quot;*not including acting officeholders, visiting dignitaries, auxiliary executive and military personnel and most diplomats&quot;</code></pre>
<p>Here, the table I want is the sixth one. We can grab it by either using double square brackets – <code>[[6]]</code> – or <code>purrr</code>’s <code>pluck(6)</code>.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="day3.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb108-2"><a href="day3.html#cb108-2" aria-hidden="true" tabindex="-1"></a>senators <span class="ot">&lt;-</span> tables <span class="sc">%&gt;%</span> </span>
<span id="cb108-3"><a href="day3.html#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="dv">6</span>)</span>
<span id="cb108-4"><a href="day3.html#cb108-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-5"><a href="day3.html#cb108-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(senators)</span></code></pre></div>
<pre><code>## Rows: 100
## Columns: 12
## $ State                        &lt;chr&gt; &quot;Alabama&quot;, &quot;Alabama&quot;, &quot;Alaska&quot;, &quot;Alaska&quot;,…
## $ Portrait                     &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ Senator                      &lt;chr&gt; &quot;Richard Shelby&quot;, &quot;Tommy Tuberville&quot;, &quot;Li…
## $ Party                        &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ Party                        &lt;chr&gt; &quot;Republican[d]&quot;, &quot;Republican&quot;, &quot;Republica…
## $ Born                         &lt;chr&gt; &quot;(1934-05-06) May 6, 1934 (age 88)&quot;, &quot;(19…
## $ `Occupation(s)`              &lt;chr&gt; &quot;Lawyer&quot;, &quot;College football coachPartner,…
## $ `Previous electiveoffice(s)` &lt;chr&gt; &quot;U.S. HouseAlabama Senate&quot;, &quot;None&quot;, &quot;Alas…
## $ Education                    &lt;chr&gt; &quot;University of Alabama (BA, LLB)\nBirming…
## $ `Assumed office`             &lt;chr&gt; &quot;January 3, 1987&quot;, &quot;January 3, 2021&quot;, &quot;De…
## $ Class                        &lt;chr&gt; &quot;2022Class 3&quot;, &quot;2026Class 2&quot;, &quot;2022Class …
## $ `Residence[2]`               &lt;chr&gt; &quot;Tuscaloosa&quot;, &quot;Auburn[3]&quot;, &quot;Girdwood&quot;, &quot;A…</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="day3.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="do">## alternative approach using css</span></span>
<span id="cb110-2"><a href="day3.html#cb110-2" aria-hidden="true" tabindex="-1"></a>senators <span class="ot">&lt;-</span> us_senators <span class="sc">%&gt;%</span> </span>
<span id="cb110-3"><a href="day3.html#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_elements</span>(<span class="at">css =</span> <span class="st">&quot;#senators&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb110-4"><a href="day3.html#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_table</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb110-5"><a href="day3.html#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pluck</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb110-6"><a href="day3.html#cb110-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span></code></pre></div>
<p>You can see that the tibble contains “dirty” names and that the party column appears twice – which will make it impossible to work with the tibble later on. Hence, I use <code>clean_names()</code> from the <code>janitor</code> package to fix that.</p>
</div>
<div id="extracting-attributes" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Extracting attributes<a href="day3.html#extracting-attributes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can also extract attributes such as links using <code>html_attrs()</code>. An example would be to extract the headlines and their corresponding links from r-bloggers.com.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="day3.html#cb111-1" aria-hidden="true" tabindex="-1"></a>rbloggers <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;https://www.r-bloggers.com&quot;</span>)</span></code></pre></div>
<p>A quick check with the SelectorGadget told me that the element I am looking for is of class “.loop-title” and the child of it is “a”, standing for normal text. With <code>html_attrs()</code> I can extract the attributes. This gives me a list of named vectors containing the name of the attribute and the value:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="day3.html#cb112-1" aria-hidden="true" tabindex="-1"></a>r_blogger_postings <span class="ot">&lt;-</span> rbloggers <span class="sc">%&gt;%</span> <span class="fu">html_elements</span>(<span class="at">css =</span> <span class="st">&quot;.loop-title a&quot;</span>)</span>
<span id="cb112-2"><a href="day3.html#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="day3.html#cb112-3" aria-hidden="true" tabindex="-1"></a>r_blogger_postings <span class="sc">%&gt;%</span> <span class="fu">html_attr</span>(<span class="st">&quot;href&quot;</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;https://www.r-bloggers.com/2022/06/the-poisson-distribution-from-basic-probability-theory-to-regression-models/&quot; 
##  [2] &quot;https://www.r-bloggers.com/2022/06/visualizing-the-invasion-of-the-soviet-union-with-luftwaffe-locations/&quot;       
##  [3] &quot;https://www.r-bloggers.com/2022/06/r-shiny-google-analytics-how-to-add-ga-to-shiny-apps/&quot;                        
##  [4] &quot;https://www.r-bloggers.com/2022/06/offload-shinys-workload-covid-19-processing-for-the-who-europe/&quot;              
##  [5] &quot;https://www.r-bloggers.com/2022/06/bind-together-two-data-frames-by-their-rows-or-columns-in-r/&quot;                 
##  [6] &quot;https://www.r-bloggers.com/2022/06/create-new-variables-from-existing-variables-in-r/&quot;                           
##  [7] &quot;https://www.r-bloggers.com/2022/06/learning-from-failure-nitinol-fracture-mechanics-in-r/&quot;                       
##  [8] &quot;https://www.r-bloggers.com/2022/06/esp-curso-de-introduccion-a-shiny/&quot;                                           
##  [9] &quot;https://www.r-bloggers.com/2022/06/curso-de-introduccion-a-r-para-usuarios-de-excel-esp-3-hrs/&quot;                  
## [10] &quot;https://www.r-bloggers.com/2022/06/on-a-mobius-transformation/&quot;                                                  
## [11] &quot;https://www.r-bloggers.com/2022/06/presentamos-a-la-nueva-community-manager-de-ropensci-yanina-bellini-saibene/&quot; 
## [12] &quot;https://www.r-bloggers.com/2022/06/introducing-ropensci-new-community-manager-yanina-bellini-saibene/&quot;           
## [13] &quot;https://www.r-bloggers.com/2022/06/francophone-satrday-conference-coming-soon-save-the-date/&quot;                    
## [14] &quot;https://www.r-bloggers.com/2022/06/r-percentile/&quot;                                                                
## [15] &quot;https://www.r-bloggers.com/2022/06/r-min-and-max/&quot;                                                               
## [16] &quot;https://www.r-bloggers.com/2022/06/r-factors/&quot;                                                                   
## [17] &quot;https://www.r-bloggers.com/2022/06/r-data-frame/&quot;                                                                
## [18] &quot;https://www.r-bloggers.com/2022/06/r-array/&quot;                                                                     
## [19] &quot;https://www.r-bloggers.com/2022/06/r-list/&quot;                                                                      
## [20] &quot;https://www.r-bloggers.com/2022/06/little-useless-useful-r-functions-plotting-the-decimal-and-binary-conversion/&quot;</code></pre>
<p>Links are stored as attribute “href” – hyperlink reference. <code>html_attr()</code> allows me to extract the attribute’s value. Hence, building a tibble with the article’s title and its corresponding hyperlink is straight-forward now:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="day3.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb114-2"><a href="day3.html#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> r_blogger_postings <span class="sc">%&gt;%</span> <span class="fu">html_text2</span>(),</span>
<span id="cb114-3"><a href="day3.html#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">link =</span> r_blogger_postings <span class="sc">%&gt;%</span> <span class="fu">html_attr</span>(<span class="at">name =</span> <span class="st">&quot;href&quot;</span>)</span>
<span id="cb114-4"><a href="day3.html#cb114-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 20 × 2
##    title                                                                   link 
##    &lt;chr&gt;                                                                   &lt;chr&gt;
##  1 The Poisson distribution: From basic probability theory to regression … http…
##  2 Visualizing the Invasion of the Soviet Union with Luftwaffe Locations   http…
##  3 R Shiny Google Analytics: How to Add GA to Shiny Apps                   http…
##  4 Offload Shiny’s Workload: COVID-19 processing for the WHO/Europe        http…
##  5 Bind together two data frames by their rows or columns in R             http…
##  6 Create new variables from existing variables in R                       http…
##  7 Learning from Failure – Nitinol Fracture Mechanics in R                 http…
##  8 [ESP] Curso de introducción a Shiny                                     http…
##  9 Curso de introducción a R para usuarios de Excel [ESP, 3 hrs]           http…
## 10 On a Möbius transformation                                              http…
## 11 Presentamos a la nueva Community Manager de rOpenSci, Yanina Bellini S… http…
## 12 Introducing rOpenSci new Community Manager, Yanina Bellini Saibene      http…
## 13 Francophone SatRday Conference Coming Soon – Save the Date!             http…
## 14 R Percentile                                                            http…
## 15 R min() and max()                                                       http…
## 16 R Factors                                                               http…
## 17 R Data Frame                                                            http…
## 18 R Array                                                                 http…
## 19 R List                                                                  http…
## 20 Little useless-useful R functions – Plotting the decimal and binary co… http…</code></pre>
<p>Another approach for this would be using the <code>polite</code> package and its function <code>html_attrs_dfr()</code> which binds together all the different attributes column-wise and the different elements row-wise.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="day3.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(polite)</span>
<span id="cb116-2"><a href="day3.html#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="day3.html#cb116-3" aria-hidden="true" tabindex="-1"></a>rbloggers <span class="sc">%&gt;%</span> </span>
<span id="cb116-4"><a href="day3.html#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_elements</span>(<span class="at">css =</span> <span class="st">&quot;.loop-title a&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb116-5"><a href="day3.html#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_attrs_dfr</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb116-6"><a href="day3.html#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">title =</span> <span class="dv">3</span>, </span>
<span id="cb116-7"><a href="day3.html#cb116-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">link =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb116-8"><a href="day3.html#cb116-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 20
## Columns: 2
## $ title &lt;chr&gt; &quot;The Poisson distribution: From basic probability theory to regr…
## $ link  &lt;chr&gt; &quot;https://www.r-bloggers.com/2022/06/the-poisson-distribution-fro…</code></pre>
</div>
</div>
<div id="automating-scraping" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Automating scraping<a href="day3.html#automating-scraping" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Well, grabbing singular points of data from websites is nice. However, if you want to do things such as collecting large amounts of data or multiple pages, you will not be able to do this without some automation.</p>
<p>An example here would again be the R-bloggers page. It provides you with plenty of R-related content. If you were now eager to scrape all the articles, you would first need to acquire all the different links leading to the blog postings. Hence, you would need to navigate through the site’s pages first to acquire the links.</p>
<p>In general, there are two ways to go about this. The first is to manually create a list of URLs the scraper will visit and take the content you need, therefore not needing to identify where it needs to go next. The other one would be automatically acquiring its next destination from the page (i.e., identifying the “go on” button). Both strategies can also be nicely combined with some sort of <code>session()</code>.</p>
<div id="looping-over-pages" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Looping over pages<a href="day3.html#looping-over-pages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the first approach, we need to check the URLs first. How do they change as we navigate through the pages?</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="day3.html#cb118-1" aria-hidden="true" tabindex="-1"></a>url_1 <span class="ot">&lt;-</span> <span class="st">&quot;https://www.r-bloggers.com/page/2/&quot;</span></span>
<span id="cb118-2"><a href="day3.html#cb118-2" aria-hidden="true" tabindex="-1"></a>url_2 <span class="ot">&lt;-</span> <span class="st">&quot;https://www.r-bloggers.com/page/3/&quot;</span></span>
<span id="cb118-3"><a href="day3.html#cb118-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-4"><a href="day3.html#cb118-4" aria-hidden="true" tabindex="-1"></a>initial_dist <span class="ot">&lt;-</span> <span class="fu">adist</span>(url_1, url_2, <span class="at">counts =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb118-5"><a href="day3.html#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">attr</span>(<span class="st">&quot;trafos&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb118-6"><a href="day3.html#cb118-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diag</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb118-7"><a href="day3.html#cb118-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_locate_all</span>(<span class="st">&quot;[^M]&quot;</span>)</span>
<span id="cb118-8"><a href="day3.html#cb118-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-9"><a href="day3.html#cb118-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb118-10"><a href="day3.html#cb118-10" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(url_1, <span class="at">start =</span> initial_dist[[<span class="dv">1</span>]][<span class="dv">1</span>]<span class="sc">-</span><span class="dv">5</span>, <span class="at">end =</span> initial_dist[[<span class="dv">1</span>]][<span class="dv">1</span>]<span class="sc">+</span><span class="dv">5</span>) <span class="co"># makes sense for longer urls</span></span></code></pre></div>
<pre><code>## [1] &quot;page/2/&quot;</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="day3.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_sub</span>(url_2, <span class="at">start =</span> initial_dist[[<span class="dv">1</span>]][<span class="dv">1</span>]<span class="sc">-</span><span class="dv">5</span>, <span class="at">end =</span> initial_dist[[<span class="dv">1</span>]][<span class="dv">1</span>]<span class="sc">+</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] &quot;page/3/&quot;</code></pre>
<p>There is some sort of underlying pattern and we can harness that. <code>url_1</code> refers to the second page, <code>url_2</code> to the third. Hence, if we just combine the basic URL and, say, the numbers from 1 to 10, we could then visit all the pages (exercise 3a) and extract the content we want.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="day3.html#cb122-1" aria-hidden="true" tabindex="-1"></a>urls <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">&quot;https://www.r-bloggers.com/page/&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="st">&quot;/&quot;</span>) <span class="co"># this is the stringr equivalent of paste()</span></span>
<span id="cb122-2"><a href="day3.html#cb122-2" aria-hidden="true" tabindex="-1"></a>urls</span></code></pre></div>
<pre><code>##  [1] &quot;https://www.r-bloggers.com/page/1/&quot;  &quot;https://www.r-bloggers.com/page/2/&quot; 
##  [3] &quot;https://www.r-bloggers.com/page/3/&quot;  &quot;https://www.r-bloggers.com/page/4/&quot; 
##  [5] &quot;https://www.r-bloggers.com/page/5/&quot;  &quot;https://www.r-bloggers.com/page/6/&quot; 
##  [7] &quot;https://www.r-bloggers.com/page/7/&quot;  &quot;https://www.r-bloggers.com/page/8/&quot; 
##  [9] &quot;https://www.r-bloggers.com/page/9/&quot;  &quot;https://www.r-bloggers.com/page/10/&quot;</code></pre>
<p>You can run this in a for-loop, here’s a quick revision. For the loop to run efficiently, space for every object should be pre-allocated (i.e., you create a list beforehand, and its length can be determined by an educated guess).</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="day3.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="do">## THIS IS PSEUDO CODE!!!</span></span>
<span id="cb124-2"><a href="day3.html#cb124-2" aria-hidden="true" tabindex="-1"></a>result_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="at">length =</span> <span class="fu">length</span>(urls)) <span class="co"># pre-allocate space!!!</span></span>
<span id="cb124-3"><a href="day3.html#cb124-3" aria-hidden="true" tabindex="-1"></a>starting_link <span class="ot">&lt;-</span> </span>
<span id="cb124-4"><a href="day3.html#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(urls)){</span>
<span id="cb124-5"><a href="day3.html#cb124-5" aria-hidden="true" tabindex="-1"></a>  read <span class="cf">in</span> urls[[i]]</span>
<span id="cb124-6"><a href="day3.html#cb124-6" aria-hidden="true" tabindex="-1"></a>  store page <span class="cf">in</span> result_list</span>
<span id="cb124-7"><a href="day3.html#cb124-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="letting-the-scraper-navigate-on-its-own" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Letting the scraper navigate on its own<a href="day3.html#letting-the-scraper-navigate-on-its-own" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Extracting the link on the fly is the same thing, but in the end, you need to replace the link argument with the one you extracted. You will do this in exercise 3. It is probably easiest to perform those things in a <code>while</code> loop, hence here is a quick revision:</p>
<p>Hence, our <code>while</code> loop in pseudo-code will look like this:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="day3.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="do">## THIS IS PSEUDO CODE!!!</span></span>
<span id="cb125-2"><a href="day3.html#cb125-2" aria-hidden="true" tabindex="-1"></a>output_list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="at">length =</span> 10L)</span>
<span id="cb125-3"><a href="day3.html#cb125-3" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb125-4"><a href="day3.html#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (session<span class="sc">$</span>response<span class="sc">$</span>status_code <span class="sc">==</span> <span class="dv">200</span> <span class="sc">&amp;&amp;</span> i <span class="sc">&lt;=</span> <span class="dv">10</span>) {</span>
<span id="cb125-5"><a href="day3.html#cb125-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">session</span>(start<span class="sc">-</span>url)</span>
<span id="cb125-6"><a href="day3.html#cb125-6" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb125-7"><a href="day3.html#cb125-7" aria-hidden="true" tabindex="-1"></a>  read <span class="cf">in</span> r<span class="sc">-</span>bloggers results list</span>
<span id="cb125-8"><a href="day3.html#cb125-8" aria-hidden="true" tabindex="-1"></a>  get all stuff and store it <span class="cf">in</span> output_list[[i]]</span>
<span id="cb125-9"><a href="day3.html#cb125-9" aria-hidden="true" tabindex="-1"></a>  move session to <span class="cf">next</span> page</span>
<span id="cb125-10"><a href="day3.html#cb125-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb125-11"><a href="day3.html#cb125-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-12"><a href="day3.html#cb125-12" aria-hidden="true" tabindex="-1"></a><span class="do">### reminder: how to click a button in rvest</span></span>
<span id="cb125-13"><a href="day3.html#cb125-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-14"><a href="day3.html#cb125-14" aria-hidden="true" tabindex="-1"></a><span class="fu">session</span>(<span class="st">&quot;https://www.scrapethissite.com/&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb125-15"><a href="day3.html#cb125-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">session_follow_link</span>(<span class="at">css =</span> <span class="st">&quot;.btn-default&quot;</span>) <span class="co"># just use selectorgadget to check for css selector of button</span></span></code></pre></div>
</div>
</div>
<div id="conclusion" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Conclusion<a href="day3.html#conclusion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To sum it up: when you have a good research idea that relies on Digital Trace Data that you need to collect, ask yourself the following questions:</p>
<ol style="list-style-type: decimal">
<li>Is there an R package for the web service?</li>
<li>If 1. == FALSE: Is there an API where I can get the data (if TRUE, use it)</li>
<li>If 1. == FALSE &amp; 2. == FALSE: Is screen scraping an option and any structure in the data that you can harness?</li>
</ol>
<p>If you have to rely on screen scraping, also ask yourself the question how you can minimize the number of requests you make to the server. Going back and forth on web pages or navigating through them might not be the best option since it requires multiple requests. The most efficient way is usually to try to get a list of URLs of some sort which you can then just loop over.</p>
</div>
<div id="further-links-2" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Further links<a href="day3.html#further-links-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><a href="https://www.w3schools.com/html/default.asp">More on HTML</a></li>
<li><a href="https://www.w3schools.com/css/css_selectors.asp">More on CSS selectors</a></li>
<li>The <a href="https://rvest.tidyverse.org"><code>rvest</code> vignette</a></li>
<li>A “laymen’s guide” on web scraping (<a href="https://towardsdatascience.com/functions-with-r-and-rvest-a-laymens-guide-acda42325a77">blog post</a>)</li>
</ul>
</div>
<div id="exercises-1" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Exercises<a href="day3.html#exercises-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Download all movies from the (IMDb Top250 best movies of all time list)[<a href="https://www.imdb.com/chart/top/?ref_=nv_mv_250" class="uri">https://www.imdb.com/chart/top/?ref_=nv_mv_250</a>]. Put them in a tibble with the columns <code>rank</code> – in numeric format, <code>title</code>, <code>url</code> to IMDb entry, <code>rating</code> – in numeric format.</li>
</ol>
<details>
<summary>
Solution. Click to expand!
</summary>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="day3.html#cb126-1" aria-hidden="true" tabindex="-1"></a>imdb_top250 <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;https://www.imdb.com/chart/top/?ref_=nv_mv_250&quot;</span>)</span>
<span id="cb126-2"><a href="day3.html#cb126-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-3"><a href="day3.html#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb126-4"><a href="day3.html#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">rank =</span> imdb_top250 <span class="sc">%&gt;%</span> </span>
<span id="cb126-5"><a href="day3.html#cb126-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_elements</span>(<span class="st">&quot;.titleColumn&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb126-6"><a href="day3.html#cb126-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text2</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb126-7"><a href="day3.html#cb126-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_extract</span>(<span class="st">&quot;^[0-9]+(?=</span><span class="sc">\\</span><span class="st">.)&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb126-8"><a href="day3.html#cb126-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">parse_integer</span>(),</span>
<span id="cb126-9"><a href="day3.html#cb126-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> imdb_top250 <span class="sc">%&gt;%</span> </span>
<span id="cb126-10"><a href="day3.html#cb126-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_elements</span>(<span class="st">&quot;.titleColumn a&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb126-11"><a href="day3.html#cb126-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text2</span>(),</span>
<span id="cb126-12"><a href="day3.html#cb126-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">url =</span> imdb_top250 <span class="sc">%&gt;%</span> </span>
<span id="cb126-13"><a href="day3.html#cb126-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_elements</span>(<span class="st">&quot;.titleColumn a&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb126-14"><a href="day3.html#cb126-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_attr</span>(<span class="st">&quot;href&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb126-15"><a href="day3.html#cb126-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_c</span>(<span class="st">&quot;https://www.imdb.com&quot;</span>, .),</span>
<span id="cb126-16"><a href="day3.html#cb126-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">rating =</span> imdb_top250 <span class="sc">%&gt;%</span> </span>
<span id="cb126-17"><a href="day3.html#cb126-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_elements</span>(<span class="st">&quot;strong&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb126-18"><a href="day3.html#cb126-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb126-19"><a href="day3.html#cb126-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">parse_double</span>()</span>
<span id="cb126-20"><a href="day3.html#cb126-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb126-21"><a href="day3.html#cb126-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-22"><a href="day3.html#cb126-22" aria-hidden="true" tabindex="-1"></a>imdb_top250 <span class="sc">%&gt;%</span> </span>
<span id="cb126-23"><a href="day3.html#cb126-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_elements</span>(<span class="st">&quot;a&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb126-24"><a href="day3.html#cb126-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text2</span>()</span></code></pre></div>
</details>
<ol start="2" style="list-style-type: decimal">
<li>Scrape the (British MPs Wikipedia page)[<a href="https://en.wikipedia.org/wiki/List_of_MPs_elected_in_the_2019_United_Kingdom_general_election" class="uri">https://en.wikipedia.org/wiki/List_of_MPs_elected_in_the_2019_United_Kingdom_general_election</a>].</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Scrape the table containing data on all individual MPs. (Hint: you can select and remove single lines using <code>slice()</code>, e.g., <code>tbl %&gt;% slice(1)</code> retains only the first line, <code>tbl %&gt;% slice(-1)</code> removes only the first line.)</li>
<li>Extract the links linking to individual pages. Make them readable using <code>url_absolute()</code> – <code>url_absolute("/kdfnndfkok", base = "https://wikipedia.com")</code> –&gt; <code>"https://wikipedia.com/kdfnndfkok"</code>. Add the links to the table from 1a.</li>
<li>Scrape the textual content of the <strong>first</strong> MP’s Wikipedia page.</li>
<li>(ADVANCED!) Wrap 1c. in a function called <code>scrape_mp_wiki()</code>.</li>
</ol>
<details>
<summary>
Solution. Click to expand!
</summary>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="day3.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scrape uk mps</span></span>
<span id="cb127-2"><a href="day3.html#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb127-3"><a href="day3.html#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb127-4"><a href="day3.html#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb127-5"><a href="day3.html#cb127-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-6"><a href="day3.html#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="co">#a</span></span>
<span id="cb127-7"><a href="day3.html#cb127-7" aria-hidden="true" tabindex="-1"></a>mp_table <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;https://en.wikipedia.org/wiki/List_of_MPs_elected_in_the_2019_United_Kingdom_general_election&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-8"><a href="day3.html#cb127-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_element</span>(<span class="st">&quot;#elected-mps&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-9"><a href="day3.html#cb127-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_table</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb127-10"><a href="day3.html#cb127-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-11"><a href="day3.html#cb127-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="sc">-</span><span class="dv">651</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-12"><a href="day3.html#cb127-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">clean_names</span>()</span>
<span id="cb127-13"><a href="day3.html#cb127-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-14"><a href="day3.html#cb127-14" aria-hidden="true" tabindex="-1"></a><span class="co">#b  </span></span>
<span id="cb127-15"><a href="day3.html#cb127-15" aria-hidden="true" tabindex="-1"></a>mp_links <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;https://en.wikipedia.org/wiki/List_of_MPs_elected_in_the_2019_United_Kingdom_general_election&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-16"><a href="day3.html#cb127-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_elements</span>(<span class="st">&quot;#elected-mps b a&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-17"><a href="day3.html#cb127-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_attr</span>(<span class="st">&quot;href&quot;</span>)</span>
<span id="cb127-18"><a href="day3.html#cb127-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-19"><a href="day3.html#cb127-19" aria-hidden="true" tabindex="-1"></a>table_w_link <span class="ot">&lt;-</span> mp_table <span class="sc">%&gt;%</span> </span>
<span id="cb127-20"><a href="day3.html#cb127-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">link =</span> mp_links <span class="sc">%&gt;%</span> </span>
<span id="cb127-21"><a href="day3.html#cb127-21" aria-hidden="true" tabindex="-1"></a>           <span class="fu">paste0</span>(<span class="st">&quot;https://en.wikipedia.org&quot;</span>, .))</span>
<span id="cb127-22"><a href="day3.html#cb127-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-23"><a href="day3.html#cb127-23" aria-hidden="true" tabindex="-1"></a><span class="co">#c</span></span>
<span id="cb127-24"><a href="day3.html#cb127-24" aria-hidden="true" tabindex="-1"></a>link <span class="ot">&lt;-</span> table_w_link <span class="sc">%&gt;%</span> </span>
<span id="cb127-25"><a href="day3.html#cb127-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-26"><a href="day3.html#cb127-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(link) </span>
<span id="cb127-27"><a href="day3.html#cb127-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-28"><a href="day3.html#cb127-28" aria-hidden="true" tabindex="-1"></a>link <span class="sc">%&gt;%</span> </span>
<span id="cb127-29"><a href="day3.html#cb127-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_html</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb127-30"><a href="day3.html#cb127-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_elements</span>(<span class="st">&quot;p&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-31"><a href="day3.html#cb127-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text2</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb127-32"><a href="day3.html#cb127-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_c</span>(<span class="at">collapse =</span> <span class="st">&quot; &quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-33"><a href="day3.html#cb127-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">enframe</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">value =</span> <span class="st">&quot;wiki_article&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-34"><a href="day3.html#cb127-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">link =</span> link)</span>
<span id="cb127-35"><a href="day3.html#cb127-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-36"><a href="day3.html#cb127-36" aria-hidden="true" tabindex="-1"></a><span class="co">#d</span></span>
<span id="cb127-37"><a href="day3.html#cb127-37" aria-hidden="true" tabindex="-1"></a>scrape_page <span class="ot">&lt;-</span> <span class="cf">function</span>(link){</span>
<span id="cb127-38"><a href="day3.html#cb127-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="fl">0.5</span>)</span>
<span id="cb127-39"><a href="day3.html#cb127-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb127-40"><a href="day3.html#cb127-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_html</span>(link) <span class="sc">%&gt;%</span> </span>
<span id="cb127-41"><a href="day3.html#cb127-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_elements</span>(<span class="st">&quot;p&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-42"><a href="day3.html#cb127-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text2</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb127-43"><a href="day3.html#cb127-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_c</span>(<span class="at">collapse =</span> <span class="st">&quot; &quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-44"><a href="day3.html#cb127-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">enframe</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">value =</span> <span class="st">&quot;wiki_article&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb127-45"><a href="day3.html#cb127-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">link =</span> link)</span>
<span id="cb127-46"><a href="day3.html#cb127-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb127-47"><a href="day3.html#cb127-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-48"><a href="day3.html#cb127-48" aria-hidden="true" tabindex="-1"></a>mp_wiki_entries <span class="ot">&lt;-</span> table_w_link<span class="sc">$</span>link[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span> </span>
<span id="cb127-49"><a href="day3.html#cb127-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span>{<span class="fu">scrape_page</span>(.x)})</span>
<span id="cb127-50"><a href="day3.html#cb127-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-51"><a href="day3.html#cb127-51" aria-hidden="true" tabindex="-1"></a>mp_wiki_entries_tbl <span class="ot">&lt;-</span> table_w_link <span class="sc">%&gt;%</span> </span>
<span id="cb127-52"><a href="day3.html#cb127-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mp_wiki_entries <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>())</span></code></pre></div>
</details>
<ol start="3" style="list-style-type: decimal">
<li>Scrape the 10 first pages of <a href="https://www.r-bloggers.com">R-bloggers</a> in an automated fashion. Make sure to take breaks between requests by including <code>Sys.sleep(2)</code>.</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Do so using the url vector we created above.</li>
<li>Do so by getting the link for the next page and a loop.</li>
<li>Do so by using <code>session()</code> in a loop.</li>
</ol>
<details>
<summary>
Solution. Click to expand!
</summary>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="day3.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a: check running number in URL, create new URLs, map()</span></span>
<span id="cb128-2"><a href="day3.html#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="day3.html#cb128-3" aria-hidden="true" tabindex="-1"></a>urls <span class="ot">&lt;-</span> <span class="fu">str_c</span>(<span class="st">&quot;https://www.r-bloggers.com/page/&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="st">&quot;/&quot;</span>)</span>
<span id="cb128-4"><a href="day3.html#cb128-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-5"><a href="day3.html#cb128-5" aria-hidden="true" tabindex="-1"></a>scrape_r_bloggers <span class="ot">&lt;-</span> <span class="cf">function</span>(url){</span>
<span id="cb128-6"><a href="day3.html#cb128-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb128-7"><a href="day3.html#cb128-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_html</span>(url) <span class="sc">%&gt;%</span> </span>
<span id="cb128-8"><a href="day3.html#cb128-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_elements</span>(<span class="at">css =</span> <span class="st">&quot;.loop-title a&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb128-9"><a href="day3.html#cb128-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_attrs_dfr</span>()</span>
<span id="cb128-10"><a href="day3.html#cb128-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb128-11"><a href="day3.html#cb128-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-12"><a href="day3.html#cb128-12" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(urls, scrape_r_bloggers)</span>
<span id="cb128-13"><a href="day3.html#cb128-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-14"><a href="day3.html#cb128-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-15"><a href="day3.html#cb128-15" aria-hidden="true" tabindex="-1"></a><span class="co"># b: extract the next page and move forward in the loop</span></span>
<span id="cb128-16"><a href="day3.html#cb128-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-17"><a href="day3.html#cb128-17" aria-hidden="true" tabindex="-1"></a>rbloggers <span class="sc">%&gt;%</span> <span class="fu">html_elements</span>(<span class="at">css =</span> <span class="st">&quot;.next&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">html_attr</span>(<span class="st">&quot;href&quot;</span>)</span>
<span id="cb128-18"><a href="day3.html#cb128-18" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://www.r-bloggers.com/&quot;</span></span>
<span id="cb128-19"><a href="day3.html#cb128-19" aria-hidden="true" tabindex="-1"></a>content <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="at">length =</span> 10L)</span>
<span id="cb128-20"><a href="day3.html#cb128-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-21"><a href="day3.html#cb128-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb128-22"><a href="day3.html#cb128-22" aria-hidden="true" tabindex="-1"></a>  page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url)</span>
<span id="cb128-23"><a href="day3.html#cb128-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-24"><a href="day3.html#cb128-24" aria-hidden="true" tabindex="-1"></a>  content[[i]] <span class="ot">&lt;-</span> page <span class="sc">%&gt;%</span> </span>
<span id="cb128-25"><a href="day3.html#cb128-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_elements</span>(<span class="at">css =</span> <span class="st">&quot;.loop-title a&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb128-26"><a href="day3.html#cb128-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_attrs_dfr</span>()</span>
<span id="cb128-27"><a href="day3.html#cb128-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-28"><a href="day3.html#cb128-28" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">&lt;-</span> page <span class="sc">%&gt;%</span> <span class="fu">html_elements</span>(<span class="at">css =</span> <span class="st">&quot;.next&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">html_attr</span>(<span class="st">&quot;href&quot;</span>)</span>
<span id="cb128-29"><a href="day3.html#cb128-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-30"><a href="day3.html#cb128-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb128-31"><a href="day3.html#cb128-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb128-32"><a href="day3.html#cb128-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-33"><a href="day3.html#cb128-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-34"><a href="day3.html#cb128-34" aria-hidden="true" tabindex="-1"></a><span class="co"># c: session()</span></span>
<span id="cb128-35"><a href="day3.html#cb128-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-36"><a href="day3.html#cb128-36" aria-hidden="true" tabindex="-1"></a><span class="fu">session</span>(url) <span class="sc">%&gt;%</span> <span class="fu">session_follow_link</span>(<span class="at">css =</span> <span class="st">&quot;.next&quot;</span>)</span>
<span id="cb128-37"><a href="day3.html#cb128-37" aria-hidden="true" tabindex="-1"></a>content <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">&quot;list&quot;</span>, <span class="at">length =</span> 10L)</span>
<span id="cb128-38"><a href="day3.html#cb128-38" aria-hidden="true" tabindex="-1"></a>session_page <span class="ot">&lt;-</span> <span class="fu">session</span>(url)</span>
<span id="cb128-39"><a href="day3.html#cb128-39" aria-hidden="true" tabindex="-1"></a>session_page<span class="sc">$</span>response<span class="sc">$</span>status_code</span>
<span id="cb128-40"><a href="day3.html#cb128-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-41"><a href="day3.html#cb128-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb128-42"><a href="day3.html#cb128-42" aria-hidden="true" tabindex="-1"></a>  content[[i]] <span class="ot">&lt;-</span> session_page <span class="sc">%&gt;%</span> </span>
<span id="cb128-43"><a href="day3.html#cb128-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_elements</span>(<span class="at">css =</span> <span class="st">&quot;.loop-title a&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb128-44"><a href="day3.html#cb128-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_attrs_dfr</span>()</span>
<span id="cb128-45"><a href="day3.html#cb128-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb128-46"><a href="day3.html#cb128-46" aria-hidden="true" tabindex="-1"></a>  session_page <span class="ot">&lt;-</span> session_page <span class="sc">%&gt;%</span> <span class="fu">session_follow_link</span>(<span class="at">css =</span> <span class="st">&quot;.next&quot;</span>)</span>
<span id="cb128-47"><a href="day3.html#cb128-47" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="day2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="day4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/02-scraping_unstructured.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
